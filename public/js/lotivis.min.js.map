{"version":3,"file":"lotivis.min.js","sources":["../../../src/js/shared/uuid.js","../../../src/js/components/component.js","../../../src/js/components/button.js","../../../src/js/shared/url-parameters.js","../../../src/js/language/language_de_DE.js","../../../src/js/language/language_en_EN.js","../../../src/js/language/language_fr_FR.js","../../../src/js/language/language.js","../../../src/js/components/radio-group.js","../../../src/js/components/card.js","../../../src/js/components/popup.js","../../../src/js/components/modal-popup.js","../../../src/js/pages/page.js","../../../src/js/components/option.js","../../../src/js/components/checkbox.js","../../../src/js/pages/search-page-settings-popup.js","../../../src/js/shared/colors.js","../../../src/js/shared/test-data.js","../../../src/js/time-chart/diachronic-chart.js","../../../src/js/time-chart/diachronic-chart-settings-popup.js","../../../src/js/shared/screenshot.js","../../../src/js/time-chart/diachronic-chart-card.js","../../../src/js/shared/recent-searches.js","../../../src/js/components/search-field.js","../../../src/js/components/dropdown.js","../../../src/js/components/loading-view.js","../../../src/js/pages/innovation-list-popup.js","../../../src/js/pages/search-card.js","../../../src/js/geojson/geojson.js","../../../src/js/shared/auxiliary.js","../../../src/js/map-chart/map-chart.js","../../../src/js/components/slider.js","../../../src/js/map-chart/map-chart-settings-popup.js","../../../src/js/map-chart/map-chart-card.js","../../../src/js/pages/track-popup.js","../../../src/js/pages/word-about-card.js","../../../src/js/data-model/dataset-collection.js","../../../src/js/pages/search-page.js","../../../src/js/pages/corpus-data-page.js","../../../src/js/components/progress-bar.js","../../../src/js/pages/main-page.js","../../../src/js/pages/diachronic-about-page.js","../../../src/js/pages/artists-data-page.js","../../../src/js/pages/location-data-page.js","../../../src/js/data-source/data-delegate.js","../../../src/js/data-source/default-data-delegate.js","../../../src/js/application.js"],"sourcesContent":["export function createUUID() {\n    let index = 0;\n    let usedIDs;\n    usedIDs = [];\n    function generate() {\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n            let r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    }\n    let uuid = generate();\n    while (usedIDs.indexOf(uuid) >= 0) {\n        uuid = generate();\n    }\n    return \"id-\" + uuid;\n}\n","import {createUUID} from \"../shared/uuid\";\n\n/**\n *\n * @class Component\n */\nexport class Component {\n\n    /**\n     *\n     * @param parent\n     */\n    constructor(parent) {\n        if (!parent) {\n            throw 'No parent specified.';\n        }\n        this.selector = createUUID();\n        this.parent = parent;\n    }\n\n    show() {\n        if (!this.element) return;\n        this.element.style('display', 'inline-block');\n    }\n\n    hide() {\n        if (!this.element) return;\n        this.element.style('display', 'none');\n    }\n\n    get isVisible() {\n        if (!this.element) return false;\n        return this.element.style('display') !== 'none';\n    }\n}\n","import {Component} from \"./component\";\n\n/**\n * @class Button\n * @extends Component\n */\nexport class Button extends Component {\n\n  /**\n   * Creates an instance of Button.\n   *\n   * @constructor\n   * @param {Component} parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n\n    let thisRef = this;\n    this.element = parent\n      .append('button')\n      // .classed('button', true)\n      .attr('id', this.selector)\n      .on('click', function (event) {\n        if (!thisRef.onClick) return;\n        thisRef.onClick(event);\n      });\n  }\n\n  setText(text) {\n    this.element.text(text);\n  }\n\n  setFontAwesomeImage(imageName) {\n    this.element.html('<i class=\"fas fa-' + imageName + '\"></i>');\n  }\n\n  onClick(event) {\n    // empty\n  }\n}\n","import {Application} from \"../application\";\n\n/**\n *\n * @class URLParameters\n */\nexport class URLParameters {\n\n  /**\n   * Returns the singleton instance.\n   *\n   * @returns {URLParameters}\n   */\n  static getInstance() {\n    if (!URLParameters.instance) {\n      URLParameters.instance = new URLParameters();\n    }\n    return URLParameters.instance;\n  }\n\n  /**\n   * Return the current window URL.\n   * @returns {URL}\n   */\n  getURL() {\n    return new URL(window.location.href);\n  }\n\n  getBoolean(parameter, defaultValue = false) {\n    let value = this.getURL().searchParams.get(parameter);\n    return value ? value === 'true' : defaultValue;\n  }\n\n  getString(parameter, defaultValue = '') {\n    return this.getURL().searchParams.get(parameter) || defaultValue;\n  }\n\n  set(parameter, newValue) {\n    const url = this.getURL();\n\n    if (newValue === false) {\n      url.searchParams.delete(parameter);\n    } else {\n      url.searchParams.set(parameter, newValue);\n    }\n\n    window.history.replaceState(null, null, url);\n    this.updateCurrentPageFooter();\n  }\n\n  setWithoutDeleting(parameter, newValue) {\n    const url = this.getURL();\n    url.searchParams.set(parameter, newValue);\n    window.history.replaceState(null, null, url);\n    this.updateCurrentPageFooter();\n  }\n\n  clear() {\n    const url = this.getURL();\n    const newPath = url.protocol + url.host;\n    const newURL = new URL(newPath);\n    window.history.replaceState(null, null, newURL);\n    this.updateCurrentPageFooter();\n  }\n\n  updateCurrentPageFooter() {\n    console.log('window.lotivisApplication: ' + window.lotivisApplication);\n    window.lotivisApplication.currentPage.updateFooter();\n  }\n}\n\nURLParameters.language = 'language';\nURLParameters.page = 'page';\nURLParameters.query = 'query';\nURLParameters.searchViewMode = 'search-view-mode';\nURLParameters.chartType = 'chart-type';\nURLParameters.chartShowLabels = 'chart-show-labels';\nURLParameters.chartCombineStacks = 'chart-combine-stacks';\nURLParameters.contentType = 'content-type';\nURLParameters.valueType = 'value-type';\nURLParameters.searchSensitivity = 'search-sensitivity';\nURLParameters.startYear = 'start-year';\nURLParameters.endYear = 'end-year';\n\nURLParameters.showTestData = 'show-test-data';\n","\nexport const Strings = {\n    greeting: 'Hallo Welt',\n\n    // title\n    'French Rap Corpus Visualization': 'Französiche Rap Corpus Visualisierung',\n    'Version': 'Version',\n    'Server': 'Server',\n\n    'Search': 'Suchen',\n    'Diachronic Data': 'Diachronische Daten',\n    'Diatopic Data': 'Diatopische Daten',\n    'Corpus Data': 'Korpus Daten',\n    'Artists Data': 'KünstlerInnen Daten',\n    'About the Project': 'Über das Projekt',\n\n    'Click on URL to copy it to clipboard': 'Klicken Sie auf die URL, um sie in die Zwischenablage zu kopieren',\n\n    // diachronic about\n    'Tracks': 'Lieder',\n    'Words': 'Wörter',\n    'Words (Relative)': 'Wörter (Relativ)',\n    'Types': 'Typen',\n    'Types (Relative)': 'Typen (Relativ)',\n\n    // common\n    'true': 'Ja',\n    'false': 'Nein',\n    'Back': 'Zurück',\n    'Loading...': 'Laden...',\n    'Settings': 'Einstellungen',\n    'Chart': 'Diagramm',\n    'Close': 'Schließen',\n\n    // search page\n    'Half': 'Halb',\n    'Full': 'Voll',\n    'from': 'von', // from year\n    'till': 'bis', // till year\n    'Relative': 'Relativ',\n    'Absolute': 'Absolut',\n    'Innovation List': 'Innovations-Liste',\n    'View Mode': 'Ansicht',\n    'Map': 'Karte',\n\n    // page footer\n    'Impress': 'Impressum',\n    'Privacy Policy': 'Datenschutzerklärung',\n    'Corpus loaded status': 'Korpus geladen',\n    'Language': 'Sprache',\n};\n","export const Strings = {\n    greeting: 'Hello World',\n\n    // title\n    'French Rap Corpus Visualization': 'French Rap Corpus Visualization',\n    'Version': 'Version',\n    'Server': 'Server',\n\n    'Search': 'Search',\n    'Diachronic About': 'Diachronic About',\n    'Corpus Metadata': 'Corpus Metadata',\n    'Artists Metadata': 'Artists Metadata',\n    'About': 'About',\n\n    'Click on URL to copy it to clipboard': 'Click on URL to copy it to clipboard',\n\n    // common\n    'true': 'Yes',\n    'false': 'No',\n    'Back': 'Back',\n    'Loading...': 'Loading...',\n\n    // page footer\n    'Impress': 'Impress',\n    'Privacy Policy': 'Privacy Policy',\n    'Corpus loaded status': 'Corpus loaded status',\n    'Language': 'Language',\n};\n","\n// Translation provided by Jan-Nicklas Wilsker. Thank you!\n\nexport const Strings = {\n    greeting: 'Bonjour le monde',\n\n    // title\n    'French Rap Corpus Visualization': 'Visualisation du corpus rap français ',\n    'Version': 'Version',\n    'Server': 'Serveur',\n\n    'Search': 'Chercher',\n    'Diachronic About': 'Diachronic About',\n    'Corpus Metadata': 'Métadonnées du corpus ',\n    'Artists Metadata': 'Métadonnées des artistes',\n    'About the Project': 'À propos du projet',\n\n    'Click on URL to copy it to clipboard': 'Cliquez sur l\\'URL pour la copier dans le presse-papiers',\n\n    // common\n    'true': 'Oui',\n    'false': 'Non',\n    'Back': 'Arrière',\n    'Loading...': 'Chargement...',\n    'Close': 'Conclure',\n\n    // page footer\n    'Impress': 'Impressionner',\n    'Privacy Policy': 'Politique de confidentialité',\n    'Corpus loaded status': 'Corpus chargé',\n    'Language': 'Langue',\n};\n","import {Strings as Strings_de_DE} from \"./language_de_DE\";\nimport {Strings as Strings_en_EN} from \"./language_en_EN\";\nimport {Strings as Strings_fr_FR} from \"./language_fr_FR\";\n\n/**\n * @enum\n * Enumeration of languages of the application.\n */\nexport const Language = {\n    /** Case for the english language. */\n    English: 'en_EN',\n    /** Case for the german language. */\n    German: 'de_DE',\n    /** Case for the french language. */\n    French: 'fr_FR'\n};\n\n// set default language\nLanguage.language = Language.English;\nLanguage.strings = Strings_en_EN;\n\n/**\n * Sets the language of the application to the given one.\n * @param language The language to set.\n */\nLanguage.setLanguage = function (language) {\n    switch (language) {\n        case Language.English:\n            Language.strings = Strings_en_EN;\n            break;\n        case Language.German:\n            Language.strings = Strings_de_DE;\n            break;\n        case Language.French:\n            Language.strings = Strings_fr_FR;\n            break;\n        default:\n            break;\n    }\n    Language.language = language;\n};\n\n/**\n * Returns the translated version of the given string.\n * @param string The string to be translated.\n */\nLanguage.translate = function (string) {\n    if (Language.language === Language.English) {\n        return Language.strings[string] || string;\n    } else {\n        return Language.strings[string] || ('='.repeat(string.length));\n    }\n};\n","import {Component} from \"./component\";\n\n/**\n *\n * @class RadioGroup\n * @extends Component\n */\nexport class RadioGroup extends Component {\n\n    /**\n     *\n     * @param parent The parental component.\n     */\n    constructor(parent) {\n        super(parent);\n\n        this.inputElements = [];\n        this.element = parent.append('form');\n        this.element.classed('radio-group', true);\n    }\n\n    /**\n     *\n     * @param optionId\n     * @param optionName\n     * @returns {*}\n     */\n    addOption(optionId, optionName) {\n        let inputElement = this.element\n            .append('input')\n            .attr('type', 'radio')\n            .attr('name', this.selector)\n            .attr('value', optionId)\n            .attr('id', optionId);\n\n        this.element\n            .append('label')\n            .attr('for', optionId)\n            .text(optionName || optionId);\n\n        let thisReference = this;\n        inputElement.on(\"click\", function (event) {\n            thisReference.onClick(event);\n        });\n\n        return inputElement;\n    }\n\n    /**\n     *\n     * @param options\n     * @returns {RadioGroup}\n     */\n    setOptions(options) {\n        this.removeOptions();\n        this.inputElements = [];\n        for (let i = 0; i < options.length; i++) {\n            let id = options[i][0] || options[i].id;\n            let name = options[i][1] || options[i].translatedTitle;\n            let inputElement = this.addOption(id, name);\n            if (i === 0) {\n                inputElement.attr('checked', 'true');\n            }\n            this.inputElements.push(inputElement);\n        }\n        return this;\n    }\n\n    /**\n     *\n     * @param selectedOption\n     * @returns {RadioGroup}\n     */\n    setSelectedOption(selectedOption) {\n        for (let i = 0; i < this.inputElements.length; i++) {\n            let inputElement = this.inputElements[i];\n            let value = inputElement.attr('value');\n            if (value === selectedOption) {\n                inputElement.attr('checked', 'true');\n            }\n        }\n        return this;\n    }\n\n    /**\n     *\n     * @returns {RadioGroup}\n     */\n    removeOptions() {\n        this.element.selectAll('input').remove();\n        this.element.selectAll('label').remove();\n        this.inputElements = [];\n        return this;\n    }\n\n    /**\n     *\n     * @param event\n     */\n    onClick(event) {\n        let element = event.target;\n        if (!element) return;\n\n        let value = element.value;\n        if (!this.onChange) return;\n\n        this.onChange(value);\n\n        return this;\n    }\n\n    // onChange(newFunction) {\n    //     this.onChange = newFunction;\n    //     return this;\n    // }\n    onChange(value) {\n    }\n}","import {Component} from \"./component\";\n\nexport class Card extends Component {\n    constructor(parent) {\n        super(parent);\n        this.element = this.parent\n            .append('div')\n            .classed('card', true);\n        this.createHeader();\n        this.createBody();\n        this.createFooter();\n    }\n\n    createHeader() {\n        this.header = this.element\n            .append('div')\n            .classed('card-header', true);\n        this.headerRow = this.header\n            .append('div')\n            .classed('row', true);\n        this.headerLeftComponent = this.headerRow\n            .append('div')\n            // .classed('col-lg-2', true)\n            .classed('col-3', true);\n        this.headerCenterComponent = this.headerRow\n            .append('div')\n            // .classed('col-lg-2', true)\n            .classed('col-6', true);\n        this.headerRightComponent = this.headerRow\n            .append('div')\n            // .classed('col-lg-10', true)\n            .classed('col-3 button-group', true)\n            .classed('text-end', true);\n        this.titleLabel = this.headerLeftComponent\n            .append('span')\n            .text(this.name);\n    }\n\n    createBody() {\n        this.body = this.element\n            .append('div')\n            .classed('card-body', true);\n        this.content = this.body\n            .append('div')\n            .attr('id', 'content');\n    }\n\n    createFooter() {\n        this.footer = this.element\n            .append('div')\n            .classed('card-footer', true);\n        this.footerRow = this.footer\n            .append('div')\n            .classed('row', true);\n        this.footerLeftComponent = this.footerRow\n            .append('div')\n            .classed('col-6', true);\n        this.footerRightComponent = this.footerRow\n            .append('div')\n            .classed('col-6', true)\n            .classed('text-end', true);\n        this.footer.style('display', 'none');\n    }\n}\n","import {Component} from './component';\nimport {createUUID} from '../shared/uuid';\nimport {Card} from './card';\nimport {Button} from './button';\nimport {Language} from '../language/language';\n\n/**\n *\n *\n * @class Popup\n * @extends Component\n */\nexport class Popup extends Component {\n\n    /**\n     * Creates a new instance of Popup.\n     *\n     * @param parent The parental component.\n     */\n    constructor(parent) {\n        super(parent);\n        this.renderUnderground(parent);\n        this.renderContainer();\n        this.renderCard();\n        this.render();\n        this.renderCloseButton();\n        this.addCloseActionListeners();\n    }\n\n    // MARK: - Render\n\n    /**\n     * Appends components to this popup.\n     *\n     * Should be overridden by subclasses.\n     */\n    render() {\n        // empty\n    }\n\n    /**\n     * Appends the 'dim' background to the given parent.\n     *\n     * @param parent The parental element.\n     */\n    renderUnderground(parent) {\n        this.modalBackgroundId = createUUID();\n        this.modalBackground = parent\n            .append('div')\n            .classed('popup-underground fade-in', true)\n            .attr('id', this.modalBackgroundId);\n    }\n\n    /**\n     *\n     */\n    renderContainer() {\n        this.elementId = createUUID();\n        this.element = this.modalBackground\n            .append('div')\n            .classed('popup', true)\n            .attr('id', this.elementId);\n    }\n\n    /**\n     *\n     */\n    renderCard() {\n        this.card = new Card(this.element);\n        this.card.element.classed('popup arrow arrow-right', true);\n    }\n\n    /**\n     * Appends a close button to the right header component.\n     */\n    renderCloseButton() {\n        this.closeButton = new Button(this.card.headerRightComponent);\n        this.closeButton.element.classed('button-small', true);\n        this.closeButton.setText(Language.translate('Close'));\n    }\n\n    /**\n     * Appends an on click listener to the button.\n     */\n    addCloseActionListeners() {\n        let validIDs = [\n            this.closeButton.selector,\n            this.modalBackgroundId\n        ];\n        let popup = this;\n        this.modalBackground.on('click', function (event) {\n            if (!event || !event.target) return;\n            if (!validIDs.includes(event.target.id)) return;\n            popup.dismiss();\n        });\n    }\n\n    // MARK: - Life Cycle\n\n    /**\n     * Tells the receiving popup that it is about to be presented.\n     *\n     * Subclasses may override.\n     */\n    willShow() {\n        // empty\n    }\n\n    /**\n     * Tells the receiving popup that it is now presented.\n     *\n     * Subclasses may override.\n     */\n    didShow() {\n        // empty\n    }\n\n    /**\n     * Presents the popup.\n     */\n    show() {\n        if (this.willShow) this.willShow();\n        this.getUnderground().style.display = 'block';\n        if (this.didShow) this.didShow();\n    }\n\n    /**\n     * Tells the receiving popup that it is about to be dismissed.\n     *\n     * Subclasses may override.\n     */\n    willDismiss() {\n        // empty\n    }\n\n    /**\n     * Tells the receiving popup that the DOM element will be removed.\n     *\n     * Subclasses may override.\n     */\n    willRemoveDOMElement() {\n        // empty\n    }\n\n    /**\n     * Dismisses the popup.\n     */\n    dismiss() {\n        if (this.willDismiss) this.willDismiss();\n        this.getUnderground().style.display = 'none';\n        if (this.willRemoveDOMElement) this.willRemoveDOMElement();\n        this.getUnderground().remove();\n    }\n\n    getUnderground() {\n        return document.getElementById(this.modalBackgroundId);\n    }\n\n    showUnder(sourceElement, position = 'center') {\n        if (!sourceElement) return;\n\n        let preferredSize = this.preferredSize();\n        let origin = this.calculateBottomCenter(sourceElement);\n\n        if (position === 'left') {\n            origin.x -= origin.width / 2;\n        } else if (position === 'right') {\n            origin.x -= preferredSize.width - origin.width / 2;\n        } else { // assume center\n            origin.x -= (preferredSize.width / 2);\n        }\n\n        let id = this.elementId;\n        let popup = document.getElementById(id);\n\n        popup.style.position = 'absolute';\n        popup.style.width = preferredSize.width + 'px';\n        // popup.style.height = preferredSize.height + 'px';\n        popup.style.left = origin.x + 'px';\n        popup.style.top = origin.y + 'px';\n\n        this.show();\n    }\n\n    showBigModal() {\n        let id = this.elementId;\n        let popup = document.getElementById(id);\n        let preferredSize = this.preferredSize();\n\n        popup.style.position = 'relative';\n        popup.style.margin = '50px auto';\n        popup.style.width = preferredSize.width + 'px';\n\n        this.show();\n    }\n\n    /**\n     * Returns the preferred size of the popup.  Subclasses may override in order to\n     * change the size of the popup.\n     *\n     * @returns {{width: number, height: number}}\n     */\n    preferredSize() {\n        return {\n            width: 300,\n            height: 300\n        };\n    }\n\n    /**\n     * Returns the bottom middle point of the passed element.\n     *\n     * @param element\n     * @param respectWindowScroll\n     * @returns {{x: number, width: number, y: number, height: number}}\n     */\n    calculateBottomCenter(element, respectWindowScroll = false) {\n        let rect = element.getBoundingClientRect();\n        let x = rect.x + (rect.width / 2);\n        let y = rect.y + rect.height;\n\n        if (respectWindowScroll) {\n            x += window.scrollX;\n            y += window.scrollY;\n        }\n\n        return {\n            x: x,\n            y: y,\n            width: rect.width,\n            height: rect.height\n        };\n    }\n}\n","import {Popup} from \"./popup\";\nimport {Language} from \"../language/language\";\n\n/**\n *\n * @class ModalPopup\n * @extends Popup\n */\nexport class ModalPopup extends Popup {\n\n    /**\n     *\n     * @param parent\n     */\n    constructor(parent) {\n        super(parent);\n        this.modalBackground\n            .classed('popup-underground', false)\n            .classed('modal-underground', true);\n    }\n\n    /**\n     *\n     */\n    render() {\n        super.render();\n        this.renderRow();\n    }\n\n    /**\n     *\n     */\n    renderRow() {\n        this.row = this.card.body\n            .append('div')\n            .classed('row', true);\n        this.content = this.row\n            .append('div')\n            .classed('col-12 info-box-margin', true);\n    }\n\n    /**\n     *\n     */\n    loadContent(url) {\n        if (!url) return;\n        console.log('url: ' + url);\n        let content = this.content;\n        d3.text(url)\n            .then(function (text) {\n                console.log(text);\n                content.html(text);\n            })\n            .catch(function (error) {\n                console.log(error);\n                content.html(Language.translate(''));\n            });\n    }\n\n    /**\n     *\n     * @returns {{width: number, height: number}}\n     */\n    preferredSize() {\n        return {\n            width: 800,\n            height: 600\n        };\n    }\n}\n","import {Button} from '../components/button';\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {Language} from \"../language/language\";\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Application} from \"../application\";\nimport {ModalPopup} from \"../components/modal-popup\";\n\nexport class Page {\n\n  constructor(application, title = 'Unknown') {\n    if (!application) {\n      throw 'No application given.';\n    }\n    this.title = title || 'Unknown';\n    this.application = application;\n    this.element = application.element;\n    this.renderHeader();\n    this.renderBody();\n    this.renderFooter();\n    application.makeContainerNormal();\n    document.title = 'FRC-Visualization - ' + this.title;\n  }\n\n\n  // MARK: - Add Components\n\n  buildSubpage() {\n    this.titleLabel = this.centerHeaderContainer.append('h1')\n      .text(this.title);\n  }\n\n  addRow(toParent = this.element) {\n    return this.addContainer(toParent, 'row');\n  }\n\n  addContainer(toParent = this.element, classes = '') {\n    let parent = toParent || this.element;\n    return parent\n      .append('div')\n      .classed(classes, true);\n  }\n\n\n  setTitle(newTitle) {\n    this.title = newTitle;\n    this.titleLabel.text(newTitle);\n  }\n\n  addSpace(toParent = this.element, width) {\n    toParent\n      .append('label')\n      .style('width', width + 'px');\n    return this;\n  }\n\n  // MARK: - Header\n\n  renderHeader() {\n    this.headerRow = this.addRow(this.element)\n      .classed('row margin-bottom', true);\n    this.leftHeaderContainer = this.headerRow\n      .append('div')\n      .classed('col-3', true);\n    this.centerHeaderContainer = this.headerRow\n      .append('div')\n      .classed('col-6 text-center', true);\n    this.rightHeaderContainer = this.headerRow\n      .append('div')\n      .classed('col-3 text-end button-group', true);\n    this.backButton = this.addBackButton(this.leftHeaderContainer);\n  }\n\n  // MARK: - Body\n\n  renderBody() {\n    this.row = this.addRow(this.element);\n  }\n\n  // MARK: - Footer\n\n  renderFooterRow() {\n    this.footerRow = this.addRow(this.element)\n      .classed('footer', true);\n  }\n\n  renderFooterLinks() {\n    this.footerLinksContainer = this.footerRow\n      .append('div')\n      .classed('col-12 text-center', true);\n\n    this.footerLinksContainer\n      .append('a')\n      .text(Language.translate('Impress'))\n      .on('click', function () {\n        let language = Language.language;\n        let url = `/html/impress-${language}.html`;\n        this.presentModalPopup(url);\n      }.bind(this));\n\n    this.footerLinksContainer\n      .append('a')\n      .text(Language.translate('Privacy Policy'))\n      .on('click', function () {\n        let language = Language.language;\n        let url = `/html/privacy-policy-${language}.html`;\n        this.presentModalPopup(url);\n      }.bind(this));\n\n    this.footerLinksContainer\n      .append('a')\n      .text(Language.translate('About the Project'))\n      .on('click', function () {\n        let language = Language.language;\n        let url = `/html/about-project-${language}.html`;\n        this.presentModalPopup(url);\n      }.bind(this));\n  }\n\n  presentModalPopup(contentURL) {\n    let parent = window.frcvApp.element;\n    let impressPopup = new ModalPopup(parent);\n    impressPopup.loadContent(contentURL);\n    impressPopup.showBigModal();\n  }\n\n  renderFooterURL() {\n\n    this.footerURLContainer = this.footerRow\n      .append('div')\n      .classed('col-12 text-center', true);\n\n    this.footerURLContainer.append('br');\n\n    this.footerTooltipContainer = this.footerURLContainer\n      .append('div')\n      .classed('tooltip', true);\n\n    this.footerURLLabel = this.footerTooltipContainer\n      .append('a')\n      .append('samp')\n      .on('click', this.copyLocationToClipboard);\n\n    let text = Language.translate('Click on URL to copy it to clipboard');\n    this.footerURLLabelTooltip = this.footerTooltipContainer\n      .append('span')\n      .classed('tooltiptext', true)\n      .text(text);\n  }\n\n  copyLocationToClipboard() {\n    let urlPath = window.location.href;\n    navigator.clipboard.writeText(urlPath).then(function () {\n      console.log('Async: Copying to clipboard was successful!');\n    }, function (err) {\n      console.error('Async: Could not copy text: ', err);\n    });\n  }\n\n  renderFooterCorpusInfo() {\n    this.footerCorpusInfoContainer = this.footerRow\n      .append('div')\n      .classed('col-12 text-center', true);\n\n    this.footerDebugLabel = this.footerCorpusInfoContainer\n      .append('samp');\n\n    this.updateFooterDebugInfo();\n  }\n\n  renderFooterLanguageInfo() {\n    this.footerLanguageInfoContainer = this.footerRow\n      .append('div')\n      .classed('col-12 text-center', true);\n\n    this.footerLanguageLabel = this.footerLanguageInfoContainer\n      .append('samp');\n\n    this.footerLanguageRadioGroup = new RadioGroup(\n      this.footerLanguageInfoContainer\n    );\n\n    this.footerLanguageRadioGroup.setOptions([\n      [Language.English, 'English'],\n      [Language.German, 'German'],\n      [Language.French, 'French'],\n    ]);\n\n    this.footerLanguageRadioGroup.onChange = function (value) {\n      Language.setLanguage(value);\n      URLParameters.getInstance().set(URLParameters.language, value);\n      Application.default.reloadPage();\n    };\n\n    this.footerLanguageRadioGroup.setSelectedOption(\n      Language.language\n    );\n\n    // this.updateFooterLanguageInfo();\n  }\n\n  renderFooter() {\n    this.renderFooterRow();\n    this.renderFooterLinks();\n    this.renderFooterURL();\n    this.renderFooterCorpusInfo();\n    this.renderFooterLanguageInfo();\n  }\n\n  // MARK: Update Footer\n\n  updateFooter() {\n    this.updateFooterURL();\n    this.updateFooterDebugInfo();\n    // this.updateFooterLanguageInfo();\n  }\n\n  updateFooterURL() {\n    let url = URLParameters.getInstance().getURL();\n    this.footerURLLabel.text(url);\n  }\n\n  updateFooterDebugInfo() {\n    let label = Language.translate('Corpus loaded status');\n    let isCorpusLoaded = this.application.isCorpusLoaded();\n    let valueTranslated = Language.translate('' + isCorpusLoaded);\n    this.footerDebugLabel.text(`${label}: ${valueTranslated}`);\n  }\n\n  // updateFooterLanguageInfo() {\n  //     let label = Language.translate('Language');\n  //     let translatedGreeting = Language.language;\n  //     let text = `${label}: ${translatedGreeting}`;\n  //     this.footerLanguageLabel.text(text);\n  // }\n\n\n  // MARK: - Loading View\n\n  addLoadingView(toParent = this.element) {\n    toParent.loadingView = toParent\n      .append('div')\n      .classed('loading-container', true);\n\n    toParent.loadingView\n      .append('div')\n      .classed('loading-card', true)\n      .text(Language.translate('Loading...'));\n\n    return toParent.loadingView;\n  }\n\n  showLoadingView() {\n    this.loadingView = this.addLoadingView(this.element);\n  }\n\n  hideLoadingView() {\n    if (!this.loadingView) return;\n    this.loadingView.remove();\n  }\n\n  // MARK: - Back Button\n\n  addBackButton(toParent = this.element) {\n    let button = new Button(toParent);\n    button.element.classed('back-button', true);\n    button.setText(Language.translate('Back'));\n    let applicationReference = this.application;\n    button.onClick = function () {\n      applicationReference.showPage('main', true);\n    };\n    return button;\n  }\n\n  showBackButton() {\n    this.backButton.element.style('visibility', 'visible');\n  }\n\n  hideBackButton() {\n    this.backButton.element.style('visibility', 'hidden');\n  }\n\n  // MARK: - Load Corpus\n\n  loadCorpusIfNeeded() {\n    this.willLoadCorpus();\n    if (this.application.isCorpusLoaded()) {\n      this.didLoadCorpus();\n    } else {\n      let ref = this;\n      this.application.loadCorpus(function () {\n        ref.didLoadCorpus();\n      });\n    }\n  }\n\n  willLoadCorpus() {\n\n  }\n\n  didLoadCorpus() {\n    this.updateFooterURL();\n    this.updateFooterDebugInfo();\n  }\n}\n","import {Language} from \"../language/language\";\n\nexport class Option {\n\n    constructor(id, title) {\n        this.id = id;\n        this.title = title || id;\n    }\n\n    get translatedTitle() {\n        return Language.translate(this.title);\n    }\n}\n","import {Component} from \"./component\";\n\nexport class Checkbox extends Component {\n    constructor(parent) {\n        super(parent);\n        this.renderInput();\n        this.renderLabel();\n    }\n\n    // MARK: - Life Cycle\n    renderInput() {\n        let thisReference = this;\n        this.element = this.parent\n            .classed('radio-group', true)\n            .append('input')\n            .attr('type', 'checkbox')\n            .attr('id', this.selector)\n            .on('click', function (event) {\n                if (!event.target) {\n                    return;\n                }\n                let checkbox = event.target;\n                if (thisReference.onClick) {\n                    thisReference.onClick(checkbox.checked);\n                }\n            });\n    }\n\n    renderLabel() {\n        this.label = this.parent\n            .append('label')\n            .attr('for', this.selector)\n            .text('Unknown');\n    }\n\n    // MARK: - Functions\n    setText(text) {\n        this.label.text(text);\n        return this;\n    }\n\n    setChecked(checked) {\n        this.element.attr('checked', checked === true ? checked : null);\n        return this;\n    }\n\n    onClick(checked) {\n        // empty\n        console.log('onClick: ' + checked);\n    }\n\n    enable() {\n        this.element.attr('disabled', null);\n        this.label.style('color', 'black');\n    }\n\n    disable() {\n        this.element.attr('disabled', true);\n        this.label.style('color', 'gray');\n    }\n}\n","import {Popup} from '../components/popup';\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Option} from \"../components/option\";\nimport {SearchPage} from \"./search-page\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {Language} from \"../language/language\";\nimport {Checkbox} from \"../components/checkbox\";\n\n/**\n *\n * @class SearchPageSettingsPopup\n * @extends Popup\n */\nexport class SearchPageSettingsPopup extends Popup {\n\n    preferredSize() {\n        return {width: 320, height: 300};\n    }\n\n    /**\n     * Override `Popup` component.\n     */\n    render() {\n        // this.card.header.style('display', 'none');\n        this.renderViewRadioGroup();\n        this.renderShowChartCheckbox();\n        this.renderShowMapCheckbox();\n        this.renderShowWordAboutCheckbox();\n    }\n\n    /**\n     *\n     */\n    renderCard() {\n        super.renderCard();\n        this.row = this.card.body\n            .append('div')\n            .classed('row margin-top', true);\n    }\n\n    /**\n     *\n     */\n    renderViewRadioGroup() {\n        // this.card.body.append('p');\n\n        this.viewRadioGroupLabel = this.row\n            .append('div')\n            .classed('col-4 text-end', true)\n            .text(Language.translate('View Mode') + ':');\n\n        this.viewRadioGroupContainer = this.row\n            .append('div')\n            .classed('col-8', true);\n\n        this.viewRadioGroup = new RadioGroup(this.viewRadioGroupContainer);\n        this.viewRadioGroup.setOptions([\n            new Option('half', 'Half'),\n            new Option('full', 'Full')\n        ]);\n\n        this.viewRadioGroup.onChange = function (value) {\n            if (!this.searchPage) return;\n            this.searchPage.setViewMode(value, true);\n            URLParameters.getInstance().set(URLParameters.searchViewMode, value);\n        }.bind(this);\n    }\n\n    /**\n     *\n     */\n    renderShowChartCheckbox() {\n        this.showChartCheckboxLabel = this.row.append('div').classed('col-4 text-end', true);\n        this.showChartCheckboxContainer = this.row.append('div').classed('col-8', true);\n        this.showChartCheckbox = new Checkbox(this.showChartCheckboxContainer);\n        this.showChartCheckbox.setText(Language.translate('Show Chart'));\n        this.showChartCheckbox.onClick = function (value) {\n            value ? this.searchPage.showChart() : this.searchPage.hideChart();\n            URLParameters.getInstance().setWithoutDeleting('show-chart', value);\n        }.bind(this);\n    }\n\n    /**\n     *\n     */\n    renderShowMapCheckbox() {\n        this.showMapCheckboxLabel = this.row.append('div').classed('col-4 text-end', true);\n        this.showMapCheckboxContainer = this.row.append('div').classed('col-8', true);\n        this.showMapCheckbox = new Checkbox(this.showMapCheckboxContainer);\n        this.showMapCheckbox.setText(Language.translate('Show Map'));\n        this.showMapCheckbox.onClick = function (value) {\n            value ? this.searchPage.showMap() : this.searchPage.hideMap();\n            URLParameters.getInstance().setWithoutDeleting('show-map', value);\n        }.bind(this);\n    }\n\n    /**\n     *\n     */\n    renderShowWordAboutCheckbox() {\n        this.showWordAboutCheckboxLabel = this.row.append('div').classed('col-4 text-end', true);\n        this.showWordAboutCheckboxContainer = this.row.append('div').classed('col-8', true);\n        this.showWordAboutCheckbox = new Checkbox(this.showWordAboutCheckboxContainer);\n        this.showWordAboutCheckbox.setText(Language.translate('Show Word About'));\n        this.showWordAboutCheckbox.onClick = function (value) {\n            value ? this.searchPage.showWordAbout() : this.searchPage.hideWordAbout();\n            URLParameters.getInstance().setWithoutDeleting('show-word-about', value);\n        }.bind(this);\n    }\n\n    /**\n     *\n     */\n    willShow() {\n        super.willShow();\n        this.card.headerRow.append('h3').text(Language.translate('Settings'));\n        this.loadValues();\n    }\n\n    loadValues() {\n        let searchPage = this.searchPage;\n        this.viewRadioGroup.setSelectedOption(searchPage.viewMode);\n        this.showChartCheckbox.setChecked(searchPage.diachronicChartCard.isVisible);\n        this.showMapCheckbox.setChecked(searchPage.mapChartCard.isVisible);\n        this.showWordAboutCheckbox.setChecked(searchPage.wordAboutCard.isVisible);\n    }\n}\n\n/**\n * Enumeration of available view modes.\n * @enum\n */\nSearchPageSettingsPopup.ViewMode = {\n    Half: 'Half',\n    Full: 'Full'\n};\n","export function randomColor() {\n  return \"rgb(\" +\n    (Math.random() * 255) + \", \" +\n    (Math.random() * 255) + \",\" +\n    (Math.random() * 255) + \")\";\n}\n\nexport class Color {\n  constructor(r, g, b) {\n    this.r = Math.round(r);\n    this.g = Math.round(g);\n    this.b = Math.round(b);\n  }\n\n  rgbString() {\n    return `rgb(${this.r},${this.g},${this.b})`;\n  }\n\n  colorAdding(r, g, b) {\n    return new Color(this.r + r, this.g + g, this.b + b);\n  }\n}\n\nColor.organgeLow = new Color(250, 211, 144);\nColor.organgeHigh = new Color(229, 142, 38);\nColor.redLow = new Color(248, 194, 145);\nColor.redHigh = new Color(183, 21, 64);\nColor.blueLow = new Color(106, 137, 204);\nColor.blueHigh = new Color(12, 36, 97);\nColor.lightBlueLow = new Color(130, 204, 221);\nColor.lightBlueHight = new Color(10, 61, 98);\nColor.greenLow = new Color(184, 233, 148);\nColor.greenHight = new Color(7, 153, 146);\n\nColor.stackColors = [\n  [Color.blueHigh, Color.blueLow],\n  [Color.redHigh, Color.redLow],\n  [Color.greenHight, Color.greenLow],\n  [Color.organgeHigh, Color.organgeLow],\n  [Color.lightBlueHight, Color.lightBlueLow],\n];\n// Returns a collection of colors with the given amount.\n//\nexport function colorsForStack(stack, amount) {\n\n  if (!Number.isInteger(stack)) {\n    return [Color.stackColors[0]];\n  }\n\n  let usedAmount = Math.max(amount, 5);\n  let stackColors = Color.stackColors[stack % Color.stackColors.length];\n  let highColor = stackColors[0];\n  let lowColor = stackColors[1];\n  let redDiff = lowColor.r - highColor.r;\n  let greenDiff = lowColor.g - highColor.g;\n  let blueDiff = lowColor.b - highColor.b;\n  let redStep = redDiff / usedAmount;\n  let greenStep = greenDiff / usedAmount;\n  let blueStep = blueDiff / usedAmount;\n  let colors = [];\n\n  for (let i = 0; i < amount; i++) {\n    let newColor = highColor.colorAdding(redStep * i, greenStep * i, blueStep * i);\n    colors.push(newColor);\n  }\n\n  return colors;\n}\n","export class TestData {\n}\n\nTestData.datasets = [\n  {\n    label: 'Merde',\n    stack: 'Merde',\n    data: [\n      {label: 2012, year: 2012, yearTotal: 100, value: 12},\n      {label: 2013, year: 2013, yearTotal: 120, value: 24},\n      {label: 2014, year: 2014, yearTotal: 140, value: 12},\n    ]\n  },\n  {\n    label: 'Gucci',\n    stack: 'Gucci,Lacoste',\n    data: [\n      {label: 2012, year: 2012, yearTotal: 100, value: 5},\n      {label: 2013, year: 2013, yearTotal: 120, value: 10},\n      {label: 2014, year: 2014, yearTotal: 140, value: 15},\n    ]\n  },\n  {\n    label: 'Lacoste',\n    stack: 'Gucci,Lacoste',\n    data: [\n      {label: 2012, year: 2012, yearTotal: 100, value: 8},\n      {label: 2013, year: 2013, yearTotal: 120, value: 8},\n      {label: 2014, year: 2014, yearTotal: 140, value: 5},\n    ]\n  },\n  {\n    label: 'Nike',\n    stack: 'Nike,Puma',\n    data: [\n      {label: 2012, year: 2012, yearTotal: 100, value: 2},\n      {label: 2013, year: 2013, yearTotal: 120, value: 4},\n      {label: 2014, year: 2014, yearTotal: 140, value: 20},\n    ]\n  },\n  {\n    label: 'Puma',\n    stack: 'Nike,Puma',\n    data: [\n      {label: 2012, year: 2012, yearTotal: 100, value: 15},\n      {label: 2013, year: 2013, yearTotal: 120, value: 30},\n      {label: 2014, year: 2014, yearTotal: 140, value: 10},\n    ]\n  }\n];\n","import {Component} from \"../components/component\";\nimport {Color, colorsForStack} from \"../shared/colors\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {TestData} from \"../shared/test-data\";\n\n/**\n *\n * @class Diachronic Chart Component\n * @extends Component\n */\nexport class DiachronicChart extends Component {\n\n  /**\n   * Creates an instance of DiachronicChart.\n   *\n   * @constructor\n   * @param {Component} parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n    if (!parent) {\n      throw 'No parent specified.';\n    }\n    if (Object.getPrototypeOf(parent) === String.prototype) {\n      this.selector = parent;\n      this.element = d3.select('#' + parent);\n    } else {\n      this.element = parent;\n    }\n    this.initialize();\n    this.update();\n  }\n\n  /**\n   * Initializes this diachronic chart by setting the default values.\n   */\n  initialize() {\n    this.width = 1000;\n    this.height = 600;\n    this.defaultMargin = 60;\n    this.margin = {\n      top: this.defaultMargin,\n      right: this.defaultMargin,\n      bottom: this.defaultMargin,\n      left: this.defaultMargin\n    };\n\n    this.datasets = [];\n    this.presentedDatasetGroups = [];\n    this.presentedStacks = [];\n\n    this.labelColor = new Color(155, 155, 155).rgbString();\n    this.type = DiachronicChart.ChartType.Bar;\n    this.valueType = 'relative';\n\n    this.isShowLabels = false;\n    this.isCombineStacks = false;\n\n    this.numberFormat = new Intl.NumberFormat('de-DE', {\n      maximumFractionDigits: 3\n    });\n\n    if (URLParameters.getInstance().getBoolean(URLParameters.showTestData)) {\n      this.datasets = TestData.datasets;\n    }\n  }\n\n  /**\n   *\n   * @param datasets\n   */\n  set datasets(datasets) {\n    this._datasets = datasets;\n    this._datasets.forEach(dataset => dataset.isEnabled = true);\n  }\n\n\n  // MARK: - Life Cycle\n\n  /**\n   * Updates the receiver by calling the draw chart chain: `beforeDrawChart()`,\n   * `drawChart()` and `afterDrawChart()`.\n   */\n  update() {\n    this.beforeDrawChart();\n    this.drawChart();\n    this.afterDrawChart();\n  }\n\n  /**\n   * Does some (pre)calculations for drawing the chart.\n   */\n  beforeDrawChart() {\n    this.configureChart();\n    this.calculatePresentedDatasets();\n    this.calculateListOfDatasetNames();\n    this.calculateListOfYears();\n    this.calculateListOfStacks();\n    this.calculateFlattenData();\n    this.calculateDatasetsPerYear();\n    this.calculateColors();\n    this.calculateDatasetStacks();\n  }\n\n  /**\n   * Creates and renders the chart.\n   */\n  drawChart() {\n    this.createSVG();\n\n    // if (this.datasetStacks.length === 0) return;\n\n    this.createGraph();\n    this.createScales();\n    this.createAxis();\n\n    this.renderAxis();\n    this.renderGrid();\n    this.renderStacks();\n\n    this.renderLegend();\n  }\n\n  // MARK: - Calculate Data\n\n  /**\n   *\n   */\n  configureChart() {\n    this.renderMethod = this.type === 'Bar' ? this.renderBars : this.renderLine;\n    let margin = this.margin;\n    this.graphWidth = this.width - margin.left - margin.right;\n    this.graphHeight = this.height - margin.top - margin.bottom;\n  }\n\n  /**\n   *\n   */\n  calculatePresentedDatasets() {\n    this.presentedDatasets = this._datasets.filter(dataset => dataset.isEnabled);\n  }\n\n  /**\n   *\n   */\n  calculateDatasetStacks() {\n    let datasetRef = this.presentedDatasets;\n    let datasetsPerYearRef = this.presentedDatasetsPerYear;\n\n    this.datasetStacks = this.listOfStacks.map(function (stackName, index) {\n\n      let stackCandidates = datasetRef.filter(dataset => dataset.stack === stackName);\n      let candidatesNames = stackCandidates.map(stackCandidate => stackCandidate.label);\n      let candidatesColors = stackCandidates.map(stackCandidate => stackCandidate.color);\n\n      let stack = d3.stack()\n        .keys(candidatesNames)\n        (datasetsPerYearRef);\n\n      stack.label = stackName;\n      stack.stack = stackName;\n      stack.colors = candidatesColors;\n\n      return stack;\n    });\n\n\n    this.allDatasetStacks = this.listOfAllStacks.map(function (stackName) {\n\n      let stackCandidates = this._datasets.filter(dataset => dataset.stack === stackName);\n      let candidatesNames = stackCandidates.map(stackCandidate => stackCandidate.label);\n      let candidatesColors = stackCandidates.map(stackCandidate => stackCandidate.color);\n\n      let stack = d3.stack()\n        .keys(candidatesNames)\n        (this.datasetsPerYear);\n\n      stack.label = stackName;\n      stack.stack = stackName;\n      stack.colors = candidatesColors;\n\n      return stack;\n    }.bind(this));\n  }\n\n  /**\n   *\n   */\n  calculateListOfStacks() {\n    let temporaryMap = d3.map(this.presentedDatasets, dataset => dataset.stack || dataset.label);\n    this.listOfStacks = Array.from(new Set(temporaryMap));\n\n    let temporaryMap2 = d3.map(this._datasets, dataset => dataset.stack || dataset.label);\n    this.listOfAllStacks = Array.from(new Set(temporaryMap2));\n  }\n\n  /**\n   *\n   */\n  calculateListOfYears() {\n    if (this.presentedDatasets.length > 0) {\n      this.listOfYears = this.presentedDatasets[0].data.map(item => item.year);\n    } else {\n      this.listOfYears = [];\n    }\n  }\n\n  /**\n   *\n   */\n  calculateListOfDatasetNames() {\n    this.listOfDatasetNames = this.presentedDatasets.map(dataset => dataset.label);\n  }\n\n  /**\n   *\n   */\n  calculateDatasetsPerYear() {\n    let flattenData = this.flattenData;\n    this.datasetsPerYear = this.listOfYears.map(function (year) {\n      let yearSet = {year: year};\n      flattenData\n        .filter(item => item.year === year)\n        .forEach(function (entry) {\n          yearSet[entry.label] = entry.value;\n          yearSet.total = entry.yearTotal;\n        });\n      return yearSet;\n    });\n\n    this.presentedDatasetsPerYear = this.listOfYears.map(function (year) {\n      let yearSet = {year: year};\n      flattenData\n        .filter(item => item.year === year)\n        .filter(item => item.isEnabled === true)\n        .forEach(function (entry) {\n          yearSet[entry.label] = entry.value;\n          yearSet.total = entry.yearTotal;\n        });\n      return yearSet;\n    });\n  }\n\n  /**\n   *\n   */\n  calculateFlattenData() {\n    this.flattenData = this._datasets.map(function (dataset) {\n      dataset.data.forEach(function (item) {\n        item.label = dataset.label;\n        item.stack = dataset.stack;\n        item.key = dataset.stack;\n        item.isEnabled = dataset.isEnabled;\n      });\n      return dataset.data;\n    }).flat(1);\n  }\n\n  /**\n   *\n   */\n  calculateColors() {\n    for (let index = 0; index < this.listOfAllStacks.length; index++) {\n      let stackName = this.listOfAllStacks[index];\n      let datasets = this._datasets.filter(dataset => dataset.stack === stackName);\n      let numberOfDatasets = datasets.length;\n      let colors = colorsForStack(index, numberOfDatasets);\n\n      for (let index = 0; index < colors.length; index++) {\n        datasets[index].color = colors[index];\n      }\n    }\n  }\n\n  /**\n   * Does some calculations after drawing the chart.\n   */\n  afterDrawChart() {\n\n  }\n\n  // MARK: - SVG\n\n  /**\n   * Removes all `svg`s from the parental element.\n   */\n  removeSVG() {\n    this.element\n      .selectAll('svg')\n      .remove();\n  }\n\n  /**\n   *\n   */\n  createSVG() {\n    this.removeSVG();\n    this.svg = this.element\n      .append('svg')\n      // .attr('width', this.width)\n      // .attr('height', this.height)\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr(\"viewBox\", `0 0 ${this.width} ${this.height}`)\n      .attr('id', DiachronicChart.svgID);\n\n    let image = new Image;\n\n    // let aspect = this.width / this.height;\n    // d3.select(window)\n    //     .on(\"resize\", function () {\n    //         var targetWidth = this.element.node().getBoundingClientRect().width;\n    //         console.log('targetWidth: ' + targetWidth);\n    //         this.width = targetWidth;\n    //         this.height = targetWidth / aspect;\n    //         this.svg.attr(\"width\", targetWidth);\n    //         this.svg.attr(\"height\", targetWidth / aspect);\n    //         this.update();\n    //     }.bind(this));\n  }\n\n  /**\n   *\n   */\n  createGraph() {\n    this.graph = this.svg\n      .append('g')\n      .attr('width', this.graphWidth)\n      .attr('height', this.graphHeight)\n      .attr('transform', `translate(${this.margin.left}, ${this.margin.top})`);\n  }\n\n  /**\n   *\n   */\n  createScales() {\n\n    // console.log('this.listOfYears: ' + this.listOfYears);\n    // console.log('this.listOfDatasetNames: ' + this.listOfDatasetNames);\n    // console.log('this.listOfStacks: ' + this.listOfStacks);\n\n    let max = d3.max(this.allDatasetStacks, function (stack) {\n      return d3.max(stack, function (serie) {\n        let values = serie.map(item => item['1']);\n        return d3.max(values);\n      });\n    });\n    this.max = max;\n    console.log('this.max: ' + this.max);\n\n    this.xChart = d3.scaleBand()\n      .domain(this.listOfYears)\n      .rangeRound([this.margin.left, this.width - this.margin.right])\n      .paddingInner(0.1);\n\n    this.xDataset = d3.scaleBand()\n      .domain(this.listOfDatasetNames)\n      .rangeRound([0, this.xChart.bandwidth()])\n      .padding(0.05);\n\n    this.xStack = d3.scaleBand()\n      .domain(this.listOfStacks)\n      .rangeRound([0, this.xChart.bandwidth()])\n      .padding(0.05);\n\n    this.yChart = d3.scaleLinear()\n      .domain([0, max]).nice()\n      .rangeRound([this.height - this.margin.bottom, this.margin.top]);\n  }\n\n  /**\n   *\n   */\n  createAxis() {\n    this.xAxisGrid = d3\n      .axisBottom(this.xChart)\n      .tickSize(-this.graphHeight)\n      .tickFormat('');\n\n    this.yAxisGrid = d3\n      .axisLeft(this.yChart)\n      .tickSize(-this.graphWidth)\n      .tickFormat('')\n      .ticks(20);\n  }\n\n\n  // MARK: - Render\n\n  /**\n   *\n   */\n  renderAxis() {\n    this.svg\n      .append(\"g\")\n      .call(d3.axisBottom(this.xChart))\n      .attr(\"transform\", dataset => `translate(0,${this.height - this.margin.bottom})`);\n    this.svg\n      .append(\"g\")\n      .call(d3.axisLeft(this.yChart))\n      .attr(\"transform\", dataset => `translate(${this.margin.left},0)`);\n  }\n\n\n  // MARK: - Grid\n\n  /**\n   *\n   */\n  renderGrid() {\n    this.svg\n      .append('g')\n      .attr('class', 'x axis-grid')\n      .attr('transform', 'translate(0,' + (this.height - this.margin.bottom) + ')')\n      .attr('stroke', 'lightgray')\n      .attr('stroke-width', '0.5')\n      .attr(\"opacity\", 0.3)\n      .call(this.xAxisGrid);\n    this.svg\n      .append('g')\n      .attr('class', 'y axis-grid')\n      .attr('transform', `translate(${this.margin.left},0)`)\n      .attr('stroke', 'lightgray')\n      .attr('stroke-width', '0.5')\n      .attr(\"opacity\", 0.3)\n      .call(this.yAxisGrid);\n  }\n\n  /**\n   *\n   */\n  renderStacks() {\n    for (let index = 0; index < this.datasetStacks.length; index++) {\n      this.renderBars(this.datasetStacks[index], index);\n    }\n\n    if (this.isShowLabels === false) return;\n    for (let index = 0; index < this.datasetStacks.length; index++) {\n      this.renderBarLabels(this.datasetStacks[index], index);\n    }\n  }\n\n\n  // MARK: - Bars\n\n  /**\n   *\n   * @param stack\n   * @param index\n   */\n  renderBars(stack, index) {\n    let xChartRef = this.xChart;\n    let yChartRef = this.yChart;\n    let xStackRef = this.xStack;\n    this.svg.append(\"g\")\n      .selectAll(\"g\")\n      .data(stack)\n      .enter()\n      .append(\"g\")\n      .attr(\"fill\", function (dataset, index) {\n        if (this.isCombineStacks) {\n          return stack.colors[0].rgbString();\n        } else {\n          return stack.colors[index].rgbString();\n        }\n      }.bind(this))\n      .selectAll(\"rect\")\n      .data(function (data) {\n        return data;\n      })\n      .enter()\n      .append(\"rect\")\n      .attr(\"rx\", function () {\n        return this.isCombineStacks ? 0 : 4;\n      }.bind(this))\n      .attr(\"x\", function (d) {\n        return xChartRef(d.data.year) + xStackRef(stack.label);\n      })\n      .attr(\"y\", function (d) {\n        return yChartRef(d[1]);\n      })\n      .attr(\"height\", function (d) {\n        return yChartRef(d[0]) - yChartRef(d[1]);\n      })\n      .attr(\"width\", xStackRef.bandwidth());\n  }\n\n  /**\n   *\n   * @param stack\n   * @param index\n   */\n  renderBarLabels(stack, index) {\n    let xChartRef = this.xChart;\n    let yChartRef = this.yChart;\n    let xStackRef = this.xStack;\n    let numberFormat = this.numberFormat;\n    let labelColor = this.labelColor;\n    let numberOfSeries = stack.length;\n    let serieIndex = 0;\n\n    this.svg.append(\"g\")\n      .selectAll('g')\n      .data(stack)\n      .enter()\n      .append('g')\n      .attr('fill', labelColor)\n      .selectAll('.text')\n      .data(function (dataset) {\n        return dataset;\n      })\n      .enter()\n      .append('text')\n      .attr(\"transform\", function (item) {\n        let x = xChartRef(item.data.year) + xStackRef(stack.label) + (xStackRef.bandwidth() / 2);\n        let y = yChartRef(item[1]) - 5;\n        return `translate(${x},${y})rotate(-60)`;\n      })\n      .attr(\"font-size\", 13)\n      .text(function (item, index) {\n        if (index === 0) serieIndex += 1;\n        if (serieIndex !== numberOfSeries) return;\n        let value = item[1];\n        return value === 0 ? '' : numberFormat.format(value);\n      });\n  }\n\n  // MARK: - Line\n\n  /**\n   *\n   * @returns {*}\n   */\n  createLine() {\n    if (this.datasetGroups.length === 0) {\n      return debug('no datasets given to render lines.');\n    }\n    for (let i = 0; i < this.presentedDatasetGroups.length; i++) {\n      let dataset = this.presentedDatasetGroups[i];\n      let color = colorsForStack(i, 1)[0];\n      dataset.color = color;\n      this.renderLine(dataset);\n    }\n  }\n\n  /**\n   *\n   * @param dataset\n   * @param index\n   */\n  renderLine(dataset, index) {\n    this.graph\n      .append(\"path\")\n      .datum(dataset.data)\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", dataset.color.rgbString())\n      .attr(\"stroke-width\", 3.5)\n      .attr(\"d\", d3.line()\n        .x((item) => this.x0(item.year))\n        .y((item) => this.y0(item.value))\n        .curve(d3.curveMonotoneX));\n\n    let dots = this.graph\n      .selectAll(\".dot\")\n      .data(dataset.data.filter((item) => item.value > 0))\n      .enter()\n      .append(\"circle\")\n      .attr(\"r\", 6)\n      .attr(\"cx\", (item) => this.x0(item.year))\n      .attr(\"cy\", (item) => this.y0(item.value))\n      .attr(\"fill\", dataset.color.rgbString());\n\n    let tooltip = this.element\n      .append(\"div\")\n      .attr(\"class\", \"toolTip\")\n      .style('z-index', '9999');\n\n    dots\n      .on(\"mousemove\", function (event, item) {\n        let text = \"<b>\" + item.searchText + \"</b>\"\n          + \" in \"\n          + \"<b>\" + item.year + \"</b>\"\n          + \"<br>Abs.: <b>\" + item.value + \"</b>\"\n          + \"<br>Rel.: <b>\" + item.relativeValue + \"</b>\"\n          + \"<br>Total Year: <b>\" + item.yearTotal + \"</b>\";\n        tooltip\n          .style(\"left\", event.pageX - 20 + \"px\")\n          .style(\"top\", event.pageY - 160 + \"px\")\n          .style(\"padding\", \"10px\")\n          .style(\"background\", \"none repeat scroll 0 0 #ffffff\")\n          .style(\"position\", \"absolute\")\n          .style(\"border\", \"1px solid \" + dataset.color.rgbString())\n          .style(\"display\", \"inline-block\")\n          .html(text);\n      })\n      .on(\"mouseout\", function (d) {\n        tooltip.style(\"display\", \"none\");\n      });\n\n    if (this.isShowLabels === true) {\n      this.renderLineLabels(dataset);\n    }\n  }\n\n  /**\n   *\n   * @param dataset\n   */\n  renderLineLabels(dataset) {\n    this.graph\n      .selectAll(\".text\")\n      .data(dataset.data.filter((item) => item.value > 0))\n      .enter()\n      .append('text')\n      .attr(\"x\", (item) => this.x0(item.year))\n      .attr(\"y\", (item) => this.y0(item.value))\n      .attr('dy', '-10')\n      .attr('text-anchor', 'middle')\n      .attr(\"font-size\", 15)\n      .attr('fill', 'gray')\n      .text((item) => this.numberFormat.format(item.value || 0));\n  }\n\n  // MARK: - Render Legend\n\n  /**\n   *\n   */\n  renderLegend() {\n    if (this.isCombineStacks) {\n      this.renderCombinedStacksLegend();\n    } else {\n      this.renderNormalLegend();\n    }\n  }\n\n  renderNormalLegend() {\n\n    let datasets = this._datasets;\n    let datasetNames = datasets.map(dataset => dataset.label);\n    let circleRadius = 6;\n    let labelMargin = 50;\n\n    let xLegend = d3.scaleBand()\n      .domain(datasetNames)\n      .rangeRound([this.margin.left, this.width - this.margin.right]);\n\n    let legends = this.graph\n      .selectAll('.legend')\n      .data(datasets)\n      .enter();\n\n    let legendsTexts = legends\n      .append('text')\n      .attr(\"font-size\", 13)\n      .attr(\"x\", function (item) {\n        return xLegend(item.label) - 30;\n      })\n      .attr(\"y\", function (item) {\n        return this.graphHeight + labelMargin;\n      }.bind(this))\n      .style('cursor', 'pointer')\n      .style(\"fill\", function (item, index) {\n        return item.color.rgbString();\n      }.bind(this))\n      .text(function (item) {\n        return `${item.label} (${this.getSumForWord(item.label)})`;\n      }.bind(this));\n\n    let legendsCircles = legends\n      .append(\"circle\")\n      .attr(\"r\", circleRadius)\n      .attr(\"cx\", function (item) {\n        return xLegend(item.label) - (circleRadius * 2) - 30;\n      }.bind(this))\n      .attr(\"cy\", function (item) {\n        return this.graphHeight + labelMargin - circleRadius + 2;\n      }.bind(this))\n      .style('cursor', 'pointer')\n      .style(\"stroke\", function (item) {\n        return item.color.rgbString();\n      }.bind(this))\n      .style(\"fill\", function (item) {\n        return item.isEnabled ? item.color.rgbString() : 'white';\n      }.bind(this))\n      .style(\"stroke-width\", 2);\n\n    legendsTexts.on('click', function (event) {\n      if (!event || !event.target) return;\n      if (!event.target.innerHTML) return;\n      let label = event.target.innerHTML.split(' ')[0];\n      this.toggleDataset(label);\n    }.bind(this));\n  }\n\n  renderCombinedStacksLegend() {\n    let stackNames = this.listOfAllStacks;\n    console.log('stackNames: ' + stackNames);\n\n    let circleRadius = 6;\n    let labelMargin = 50;\n\n    let xLegend = d3.scaleBand()\n      .domain(stackNames)\n      .rangeRound([this.margin.left, this.width - this.margin.right]);\n\n    let legends = this.graph\n      .selectAll('.legend')\n      .data(stackNames)\n      .enter();\n\n    let legendsTexts = legends\n      .append('text')\n      .attr(\"font-size\", 13)\n      .attr(\"x\", function (item) {\n        return xLegend(item) - 30;\n      })\n      .attr(\"y\", function (item) {\n        return this.graphHeight + labelMargin;\n      }.bind(this))\n      .style('cursor', 'pointer')\n      .style(\"fill\", function (item, index) {\n        return colorsForStack(index, 1)[0].rgbString();\n      }.bind(this))\n      .text(function (item) {\n        return `${item} (${this.getSumForStack(item)})`;\n      }.bind(this));\n\n    let legendsCircles = legends\n      .append(\"circle\")\n      .attr(\"r\", circleRadius)\n      .attr(\"cx\", function (item) {\n        return xLegend(item) - (circleRadius * 2) - 30;\n      }.bind(this))\n      .attr(\"cy\", function (item) {\n        return this.graphHeight + labelMargin - circleRadius + 2;\n      }.bind(this))\n      .style('cursor', 'pointer')\n      .style(\"stroke\", function (item, index) {\n        return colorsForStack(index, 1)[0].rgbString();\n      }.bind(this))\n      .style(\"fill\", function (item, index) {\n        let color = colorsForStack(index, 1)[0];\n        return item.isEnabled ? color.rgbString() : 'white';\n      }.bind(this))\n      .style(\"stroke-width\", 2);\n\n  }\n\n  /**\n   *\n   * @param label\n   */\n  toggleDataset(label) {\n    let dataset = this._datasets.find(dataset => dataset.label === label);\n    dataset.isEnabled = !dataset.isEnabled;\n    this.update();\n  }\n\n  getSumForWord(word) {\n    let values = this.flattenData\n      .filter(item => item.label === word)\n      .map(item => item.value);\n    return this.numberFormat.format(d3.sum(values));\n  }\n\n  getSumForStack(stackName) {\n    let values = this.flattenData\n      .filter(item => item.stack === stackName)\n      .map(item => item.value);\n    return d3.sum(values);\n  }\n}\n\n// MARK: - Statics\n\nDiachronicChart.svgID = 'chart-svg';\n\n/**\n * @enum\n * Enumeration of available chart types.\n */\nDiachronicChart.ChartType = {\n  /** Case for bar chart type. */\n  Bar: 'Bar',\n  /** Case for line chart type. */\n  Line: 'Line'\n};\n\n","import {Popup} from \"../components/popup\";\nimport {Checkbox} from \"../components/checkbox\";\nimport {RadioGroup} from \"../components/radio-group\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {Application} from \"../application\";\nimport {Language} from \"../language/language\";\nimport {Option} from \"../components/option\";\n\n/**\n *\n * @class DiachronicChartSettingsPopup\n * @extends Popup\n */\nexport class DiachronicChartSettingsPopup extends Popup {\n\n  render() {\n    this.card\n      .headerRow\n      .append('h3')\n      .text(Language.translate('Settings'));\n    // this.card\n    //     .header\n    //     .style('display', 'none');\n\n    this.row = this.card.body\n      .append('div')\n      .classed('row', true);\n\n    this.renderShowLabelsCheckbox();\n    this.renderCombineStacksCheckbox();\n    this.renderRadios();\n  }\n\n  renderShowLabelsCheckbox() {\n    let container = this.row.append('div').classed('col-12 margin-top', true);\n    this.showLabelsCheckbox = new Checkbox(container);\n    this.showLabelsCheckbox.setText(Language.translate('Labels'));\n    this.showLabelsCheckbox.onClick = function (checked) {\n      this.diachronicChart.isShowLabels = checked;\n      this.diachronicChart.update();\n      URLParameters.getInstance().set(URLParameters.chartShowLabels, checked);\n    }.bind(this);\n  }\n\n  renderCombineStacksCheckbox() {\n    let container = this.row.append('div').classed('col-12', true);\n    this.combineStacksCheckbox = new Checkbox(container);\n    this.combineStacksCheckbox.setText(Language.translate('Combine Stacks'));\n    this.combineStacksCheckbox.onClick = function (checked) {\n      this.diachronicChart.isCombineStacks = checked;\n      this.diachronicChart.update();\n      URLParameters.getInstance().set(URLParameters.chartCombineStacks, checked);\n    }.bind(this);\n  }\n\n  renderRadios() {\n    let container = this.row.append('div').classed('col-12', true);\n    this.typeRadioGroup = new RadioGroup(container);\n    this.typeRadioGroup.setOptions([\n      new Option('bar', 'Bar'),\n      new Option('line', 'Line')\n    ]);\n\n    this.typeRadioGroup.onChange = function (value) {\n      this.diachronicChart.type = value;\n      this.diachronicChart.update();\n      URLParameters.getInstance().set(URLParameters.chartType, value);\n    }.bind(this);\n  }\n\n  preferredSize() {\n    return {\n      width: 240,\n      height: 600\n    };\n  }\n\n  willShow() {\n    this.loadValues();\n  }\n\n  loadValues() {\n    this.showLabelsCheckbox.setChecked(this.diachronicChart.isShowLabels);\n    console.log('this.diachronicChart.showLabels: ' + this.diachronicChart.isShowLabels);\n    this.combineStacksCheckbox.setChecked(this.diachronicChart.isCombineStacks);\n    console.log('this.diachronicChart.combineGroups: ' + this.diachronicChart.isCombineStacks);\n    this.typeRadioGroup.setSelectedOption(this.diachronicChart.type);\n  }\n}\n","export function screenshotElement(selector, name) {\n    console.log('selector: ' + selector);\n    let element = document.querySelector(selector);\n    console.log('element: ' + element);\n    html2canvas(element).then(canvas => {\n        const link = document.createElement(\"a\");\n        link.setAttribute('download', name || \"name\");\n        link.href = canvas.toDataURL(\"image/jpg\");\n        document.body.appendChild(link);\n        link.click();\n        link.remove();\n    });\n}","import {Card} from \"../components/card\";\nimport {Button} from \"../components/button\";\nimport {DiachronicChart} from \"./diachronic-chart\";\nimport {createUUID} from \"../shared/uuid\";\nimport {DiachronicChartSettingsPopup} from \"./diachronic-chart-settings-popup\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {screenshotElement} from \"../shared/screenshot\";\n\n/**\n *\n *\n * @class DiachronicChartCard\n * @extends Card\n */\nexport class DiachronicChartCard extends Card {\n\n  /**\n   *\n   * @param selector\n   * @param name\n   */\n  constructor(selector, name) {\n    super(selector);\n    if (!selector) {\n      throw 'No selector specified.';\n    }\n    this.selector = selector;\n    this.name = selector;\n    this.renderChart();\n    this.renderScreenshotButton();\n    this.renderMoreActionsButton();\n    this.applyURLParameters();\n  }\n\n  /**\n   *\n   */\n  renderChart() {\n    this.chart = new DiachronicChart(this.body);\n    this.chart.margin.left = 150;\n    this.chart.margin.right = 150;\n  }\n\n  /**\n   *\n   */\n  renderScreenshotButton() {\n    this.chartID = createUUID();\n    this.body.attr('id', this.chartID);\n\n    this.screenshotButton = new Button(this.headerRightComponent);\n    this.screenshotButton.setText('Screenshot');\n    this.screenshotButton.element.classed('simple-button', true);\n    this.screenshotButton.element.html('<i class=\"fas fa-camera\"></i>');\n\n    this.screenshotButton.onClick = function (event) {\n      let name = 'my_image.jpg';\n      let chartID = this.chartID;\n      screenshotElement(\"#\" + chartID, name);\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  renderMoreActionsButton() {\n    this.moreActionButton = new Button(this.headerRightComponent);\n    this.moreActionButton.setText('More');\n    this.moreActionButton.element.classed('simple-button', true);\n    this.moreActionButton.element.html('<i class=\"fas fa-ellipsis-h\"></i>');\n    this.moreActionButton.onClick = function (event) {\n      if (!event || !event.target) return;\n      this.presentSettingsPopup();\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  applyURLParameters() {\n    this.chart.type = URLParameters.getInstance()\n      .getString(URLParameters.chartType, 'bar');\n    this.chart.isShowLabels = URLParameters.getInstance()\n      .getBoolean(URLParameters.chartShowLabels, false);\n    this.chart.isCombineStacks = URLParameters.getInstance()\n      .getBoolean(URLParameters.chartCombineStacks, false);\n  }\n\n\n  // MARK: - Settings Popup\n\n  /**\n   *\n   */\n  presentSettingsPopup() {\n    let application = window.frcvApp;\n    let button = document.getElementById(this.moreActionButton.selector);\n    let settingsPopup = new DiachronicChartSettingsPopup(application.element);\n    settingsPopup.diachronicChart = this.chart;\n    settingsPopup.showUnder(button, 'right');\n  }\n}\n","const RecentSearchesLocalStorageKey = 'de.beuth.frc-visualization.RecentSearchesLocalStorageKey';\nconst MaxItemsCount = 100;\nconst UseLocalStorage = true;\n\nexport class RecentSearches {\n  constructor() {\n    this.loadFromLocalStorage();\n  }\n\n  static getInstance() {\n    if (!RecentSearches.instance) {\n      RecentSearches.instance = new RecentSearches();\n    }\n    return RecentSearches.instance;\n  }\n\n\n  // Mark: - Append / Insert\n\n  append(searchText) {\n    this.removeIfExisting(searchText);\n    this.insert(searchText);\n    this.storeToLocalStorage();\n  }\n\n  insert(value) {\n    this.values.splice(0, 0, value);\n    this.removeDispensableValues();\n  }\n\n\n  // MARK: - Remove\n\n  removeIfExisting(value) {\n    let index = this.values.indexOf(value);\n    if (index < 0) return;\n    this.values.splice(index, 1);\n  }\n\n  removeDispensableValues() {\n    if (this.values.length < MaxItemsCount) return;\n    let tooMuch = this.values.length - MaxItemsCount;\n    console.log(\"tooMuch: \" + tooMuch);\n    this.values.splice(MaxItemsCount, tooMuch);\n  }\n\n\n  // MARK: - Local Storage\n\n  loadFromLocalStorage() {\n    let wordlist = localStorage.getItem(RecentSearchesLocalStorageKey);\n    if (wordlist) {\n      this.values = wordlist.split('\\n');\n    } else {\n      this.values = [];\n    }\n  }\n\n  storeToLocalStorage() {\n    localStorage.setItem(RecentSearchesLocalStorageKey, this.values.join('\\n'));\n  }\n}\n","import {Component} from \"./component\";\nimport {createUUID} from \"../shared/uuid\";\nimport {RecentSearches} from \"../shared/recent-searches\";\n\nexport class SearchField extends Component {\n\n    constructor(parent) {\n        super(parent);\n        if (!parent) {\n            throw 'No parent specified.';\n        }\n        this.parent = parent;\n        this.datalistId = createUUID();\n        this.element = parent\n            .append('input')\n            .classed('form-control form-control-sm', true)\n            .attr('type', 'text')\n            .attr('placeholder', 'Search Word')\n            .attr('id', this.selector)\n            .attr('list', this.datalistId);\n\n        this.datalist = parent\n            .append('datalist')\n            .attr('id', this.datalistId);\n\n        this.element.on('keyup', function (event) {\n            if (event.key !== 'Enter') return;\n            this.onEnter();\n        }.bind(this));\n\n        this.element.on('change', function (event) {\n            this.onEnter();\n        }.bind(this));\n\n        this.updateRecentSearches();\n    }\n\n    onEnter() {\n        // empty\n    }\n\n    startSearch(searchText) {\n        // empty\n    }\n\n    getText() {\n        let element = document.getElementById(this.selector);\n        return element.value;\n    }\n\n    setText(newValue) {\n        let element = document.getElementById(this.selector);\n        element.value = newValue;\n    }\n\n    updateRecentSearches() {\n        this.datalist\n            .selectAll('option')\n            .remove();\n        let recentSearches = RecentSearches.getInstance().values || [];\n        this.datalist\n            .selectAll('option')\n            .data(recentSearches)\n            .enter()\n            .append(\"option\")\n            .attr('value', (item) => item);\n    }\n}\n","import {Component} from \"./component\";\nimport {createUUID} from \"../shared/uuid\";\n\n/**\n *\n * @class Dropdown\n * @extends Component\n */\nexport class Dropdown extends Component {\n\n    constructor(parent) {\n        super(parent);\n        this.inputElements = [];\n        this.selector = createUUID();\n        this.element = parent\n            .append('div')\n            .classed('dropdown-container', true);\n        this.selectId = createUUID();\n        this.renderLabel();\n        this.renderSelect();\n    }\n\n    renderLabel() {\n        this.label = this.element\n            .append('label')\n            .attr('for', this.selectId);\n    }\n\n    renderSelect() {\n        let thisReference = this;\n        this.select = this.element\n            .append('select')\n            .classed('form-control form-control-sm', true)\n            .attr('id', this.selectId)\n            .on('change', function (event) {\n                thisReference.onClick(event);\n            });\n    }\n\n    addOption(optionId, optionName) {\n        return this.select\n            .append('option')\n            .attr('id', optionId)\n            .attr('value', optionId)\n            .text(optionName);\n    }\n\n    setOptions(options) {\n        this.removeAllInputs();\n        for (let i = 0; i < options.length; i++) {\n            let id = options[i][0] || options[i].id;\n            let name = options[i][1] || options[i].translatedTitle;\n            let inputElement = this.addOption(id, name);\n            this.inputElements.push(inputElement);\n        }\n        return this;\n    }\n\n    removeAllInputs() {\n        this.element.selectAll('input').remove();\n        return this;\n    }\n\n    onClick(event) {\n        let element = event.target;\n        if (!element) {\n            return;\n        }\n        let value = element.value;\n        if (!this.onChange) {\n            return;\n        }\n        this.onChange(value);\n        return this;\n    }\n\n    onChange(argument) {\n        console.log('argument: ' + argument);\n        if (typeof argument !== 'string') {\n            this.onChange = argument;\n        } else {\n\n        }\n        return this;\n    }\n\n    // MARK: - Chaining Setter\n\n    setLabelText(text) {\n        this.label.text(text);\n        return this;\n    }\n\n    setOnChange(callback) {\n        this.onChange = callback;\n        return this;\n    }\n\n    setSelectedOption(optionID) {\n        if (this.inputElements.find(function (item) {\n            return item.attr('value') === optionID;\n        }) !== undefined) {\n            this.value = optionID;\n        }\n        return this;\n    }\n\n    set value(optionID) {\n        document.getElementById(this.selectId).value = optionID;\n    }\n\n    get value() {\n        return document.getElementById(this.selectId).value;\n    }\n}\n","import {Component} from \"./component\";\nimport {Language} from \"../language/language\";\n\n/**\n *\n * @class LoadingView\n * @extends Component\n */\nexport class LoadingView extends Component {\n\n    /**\n     * Creates a new instance of LoadingView.\n     *\n     * @param parent The parental component.\n     */\n    constructor(parent) {\n        super(parent);\n        this.render();\n    }\n\n    /**\n     * Renders this component.\n     */\n    render() {\n        this.container = this.parent\n            .append('div')\n            .classed('loading-container', true);\n\n        this.card = this.container\n            .append('div')\n            .classed('loading-card', true)\n            .text(Language.translate('Loading...'));\n    }\n\n    /**\n     * Presents this component.\n     */\n    show() {\n        this.container.style('display', 'block');\n    }\n\n    /**\n     * Hides this component.\n     */\n    hide() {\n        this.container.style('display', 'none');\n    }\n\n    /**\n     * Removes this component.\n     */\n    remove() {\n        this.container.remove();\n    }\n}\n","import {Popup} from \"../components/popup\";\nimport {LoadingView} from \"../components/loading-view\";\nimport {Language} from \"../language/language\";\n\n/**\n *\n * @class InnovationListPopup\n * @extends Popup\n */\nexport class InnovationListPopup extends Popup {\n\n    constructor(parent) {\n        super(parent);\n    }\n\n    render() {\n        super.render();\n        this.row = this.card.body\n            .append('div')\n            .classed('row word-list', true);\n        this.card.headerRow\n            .append('h3')\n            .text(Language.translate('Innovation List'));\n    }\n\n    // MARK: - Override Popup\n\n    willShow() {\n        super.willShow();\n        this.loadingView = new LoadingView(this.row);\n\n        d3.text('/assets/InnovationList.txt')\n            .then(function (data) {\n                this.data = data.split('\\n');\n                this.loadingView.remove();\n                this.dataDidLoad();\n            }.bind(this))\n            .catch(function () {\n                this.data = [];\n                this.dataDidLoad();\n            }.bind(this));\n    }\n\n    preferredSize() {\n        return {\n            width: 400,\n            height: 0,\n        };\n    }\n\n    dataDidLoad() {\n        let reducedData = this.data.map(function (item) {\n            let components = item.split(';');\n            return {\n                title: components[0],\n                variations: components.join(',')\n            };\n        });\n\n        let thisReference = this;\n        this.row\n            .selectAll('div')\n            .append('div')\n            .data(reducedData)\n            .enter()\n            .append('div')\n            .append('a')\n            .append('span')\n            .classed('representation', true)\n            .text(item => item.title)\n            .append('span')\n            .classed('variations', true)\n            .text(item => '(' + item.variations + ')')\n            .on('click', function (item, some) {\n                thisReference.searchCard.searchField.setText('' + some.variations);\n                thisReference.searchCard.startSearching();\n                thisReference.dismiss();\n            });\n    }\n}\n","import {Card} from \"../components/card\";\nimport {SearchField} from \"../components/search-field\";\nimport {Dropdown} from \"../components/dropdown\";\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Button} from \"../components/button\";\nimport {Language} from \"../language/language\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {Option} from \"../components/option\";\nimport {InnovationListPopup} from \"./innovation-list-popup\";\nimport {Application} from \"../application\";\n\n/**\n *\n * @class SearchCard\n * @extends Card\n */\nexport class SearchCard extends Card {\n\n  /**\n   *\n   * @param parent\n   */\n  constructor(parent) {\n    super(parent);\n\n    this.header.style('display', 'none');\n    // this.footer.style('display', 'none');\n    this.row = this.body\n      .append('div')\n      .classed('row margin-top', true);\n\n    this.renderSearchField();\n    this.renderCaseSensitiveDropdown();\n    this.renderRangeDropdown();\n    this.renderRelativeAbsolute();\n    this.renderFooterRow();\n    this.renderPresentInnovationListPopupButton();\n    this.renderSearchButton();\n  }\n\n  /**\n   *\n   */\n  renderSearchField() {\n    this.searchFieldContainer = this.row\n      .append('div')\n      .classed('col-4', true);\n    this.searchField = new SearchField(this.searchFieldContainer);\n    this.searchField.onEnter = function () {\n      this.startSearching();\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  renderCaseSensitiveDropdown() {\n    this.caseSensetiveGroupContainer = this.row\n      .append('div')\n      .classed('col-2', true);\n    this.sensitivityDropdown = new Dropdown(this.caseSensetiveGroupContainer)\n      .setOptions([\n        new Option('case-sensitive', 'Case Sensitive'),\n        new Option('case-insensitive', 'Case Insensitive'),\n        // new Option('regex', 'Reg. Expression')\n      ]);\n    this.sensitivityDropdown.label.text('Sensitivity');\n    this.sensitivityDropdown.onChange = function (value) {\n      URLParameters.getInstance().set(URLParameters.searchSensitivity, value);\n      this.startSearching();\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  renderRangeDropdown() {\n    let startYear = 1995;\n    let endYear = 2020;\n    let defaultStartYear = 2000;\n    let options = [];\n    for (let year = startYear; year <= endYear; year++) {\n      options.push([year, year]);\n    }\n\n    this.yearStartContainer = this.row.append('div').classed('col-2', true);\n    this.yearStartDropdown = new Dropdown(this.yearStartContainer)\n      .setLabelText(Language.translate('from'))\n      .setOptions(options)\n      .setSelectedOption(defaultStartYear)\n      .setOnChange(function (startYear) {\n        URLParameters.getInstance().set(URLParameters.startYear, startYear);\n        this.startSearching();\n      }.bind(this));\n\n    this.yearEndContainer = this.row.append('div').classed('col-2', true);\n    this.yearEndDropdown = new Dropdown(this.yearEndContainer)\n      .setLabelText(Language.translate('till'))\n      .setOptions(options)\n      .setSelectedOption(endYear)\n      .setOnChange(function (endYear) {\n        URLParameters.getInstance().set(URLParameters.endYear, endYear);\n        this.startSearching();\n      }.bind(this));\n  }\n\n  /**\n   *\n   */\n  renderRelativeAbsolute() {\n    let container2 = this.row\n      .append('div')\n      .classed('col-2', true);\n    this.valueRadioGroup = new RadioGroup(container2);\n    this.valueRadioGroup.setOptions([\n      new Option('relative', 'Relative'),\n      new Option('absolute', 'Absolute')\n    ]);\n    this.valueRadioGroup.onChange = function (value) {\n      this.diachronicChart.valueType = value;\n      this.diachronicChart.update();\n      this.valueType = value;\n      URLParameters.getInstance().set(URLParameters.valueType, value);\n      this.startSearching();\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  renderFooterRow() {\n    this.footer = this.row\n      .append('div')\n      .classed('col-12 button-group margin-top text-end', true);\n  }\n\n  /**\n   *\n   */\n  renderPresentInnovationListPopupButton() {\n    this.presentInnovationListPopupButton = new Button(this.footer);\n    this.presentInnovationListPopupButton.element.classed('button-down', true);\n    this.presentInnovationListPopupButton.setText(Language.translate('Innovation List'));\n    this.presentInnovationListPopupButton.onClick = function (event) {\n      if (!event || !event.target) return;\n      let application = Application.default;\n      let popup = new InnovationListPopup(application.element);\n      popup.searchCard = this;\n      popup.showUnder(event.target, 'center');\n    }.bind(this);\n  }\n\n  /**\n   *\n   */\n  renderSearchButton() {\n    this.searchButton = new Button(this.footer);\n    this.searchButton.element.classed('button round-button', true);\n    this.searchButton.setText(Language.translate('Search'));\n    this.searchButton.onClick = function () {\n      this.startSearching();\n    }.bind(this);\n  }\n\n  /**\n   *\n   * @returns {string}\n   */\n  getSearchText() {\n    return this.searchField.getText();\n  }\n\n  /**\n   *\n   */\n  startSearching() {\n    // empty\n  }\n\n  /**\n   *\n   */\n  createFooter() {\n    // do not call super\n  }\n\n  // MARK: - Getter\n\n  get searchText() {\n    return this.searchField.getText();\n  }\n\n  get sensitivity() {\n    return this.sensitivityDropdown.value;\n  }\n\n  get firstYear() {\n    return this.yearStartDropdown.value;\n  }\n\n  get lastYear() {\n    return this.yearEndDropdown.value;\n  }\n}\n","/**\n *\n */\nexport class GeoJson {\n\n    constructor(source) {\n        this.type = source.type;\n        this.features = [];\n\n\n        for (let index = 0; index < source.features.length; index++) {\n            let featureSource = source.features[index];\n            let feature = new Feature(featureSource);\n            this.features.push(feature);\n        }\n    }\n\n    getCenter() {\n        let allCoordinates = this.extractAllCoordinates();\n        console.log('allCoordinates.length: ' + allCoordinates.length);\n        let latitudeSum = 0;\n        let longitudeSum = 0;\n\n        allCoordinates.forEach(function (coordinates) {\n            latitudeSum += coordinates[1];\n            longitudeSum += coordinates[0];\n        });\n\n        return [\n            latitudeSum / allCoordinates.length,\n            longitudeSum / allCoordinates.length\n        ];\n    }\n\n    extractGeometryCollection() {\n        let geometryCollection = [];\n        if (this.type === 'Feature') {\n            geometryCollection.push(this.geometry);\n        } else if (this.type === 'FeatureCollection') {\n            this.features.forEach(feature => geometryCollection.push(feature.geometry));\n        } else if (this.type === 'GeometryCollection') {\n            this.geometries.forEach(geometry => geometryCollection.push(geometry));\n        } else {\n            throw new Error('The geoJSON is not valid.');\n        }\n        return geometryCollection;\n    }\n\n    extractAllCoordinates() {\n        let geometryCollection = this.extractGeometryCollection();\n        let coordinatesCollection = [];\n\n        geometryCollection.forEach(item => {\n\n            let coordinates = item.coordinates;\n            let type = item.type;\n\n            if (type === 'Point') {\n                console.log(\"Point: \" + coordinates.length);\n                coordinatesCollection.push(coordinates);\n            } else if (type === 'MultiPoint') {\n                console.log(\"MultiPoint: \" + coordinates.length);\n                coordinates.forEach(coordinate => coordinatesCollection.push(coordinate));\n            } else if (type === 'LineString') {\n                console.log(\"LineString: \" + coordinates.length);\n                coordinates.forEach(coordinate => coordinatesCollection.push(coordinate));\n            } else if (type === 'Polygon') {\n                coordinates.forEach(function (polygonCoordinates) {\n                    polygonCoordinates.forEach(function (coordinate) {\n                        coordinatesCollection.push(coordinate);\n                    });\n                });\n            } else if (type === 'MultiLineString') {\n                coordinates.forEach(function (featureCoordinates) {\n                    featureCoordinates.forEach(function (polygonCoordinates) {\n                        polygonCoordinates.forEach(function (coordinate) {\n                            coordinatesCollection.push(coordinate);\n                        });\n                    });\n                });\n            } else if (type === 'MultiPolygon') {\n                coordinates.forEach(function (featureCoordinates) {\n                    featureCoordinates.forEach(function (polygonCoordinates) {\n                        polygonCoordinates.forEach(function (coordinate) {\n                            coordinatesCollection.push(coordinate);\n                        });\n                    });\n                });\n            } else {\n                throw new Error('The geoJSON is not valid.');\n            }\n        });\n\n        return coordinatesCollection;\n    }\n}\n\nexport class Feature {\n\n    constructor(source) {\n        this.type = source.type;\n        this.properties = source.properties;\n        this.geometry = new Geometry(source.geometry);\n    }\n}\n\nexport class Geometry {\n\n    constructor(source) {\n        this.type = source.type;\n        this.coordinates = source.coordinates;\n    }\n}\n","/**\n *\n * @param arrayOfArrays\n * @returns {[]}\n */\nexport function flatArrayOfArrays(arrayOfArrays) {\n    let flattenList = [];\n    for (let index = 0; index < arrayOfArrays.length; index++) {\n        let currentArray = arrayOfArrays[index];\n        for (let index = 0; index < currentArray.length; index++) {\n            let currentItem = currentArray[index];\n            flattenList.push(currentItem);\n        }\n    }\n    return flattenList;\n}\n\n/**\n *\n * @param datasets\n * @returns {[]}\n */\nexport function flattenDatasets(datasets) {\n    let flattenList = [];\n    for (let index = 0; index < datasets.length; index++) {\n        let dataset = datasets[index];\n        let dataCollection = dataset.data;\n        dataCollection.forEach(item => {\n            item.dataset = dataset.dlabel;\n            item.stack = dataset.stack;\n            flattenList.push(item);\n        });\n    }\n    return flattenList;\n}\n\nexport function combine(flattenList) {\n    let combined = [];\n    for (let index = 0; index < flattenList.length; index++) {\n        let listItem = flattenList[index];\n        let entry = combined.find(function (entryItem) {\n            return entryItem.stack === listItem.stack\n                && entryItem.dlabel === listItem.dlabel;\n        });\n        if (entry) {\n            entry.value += listItem.value;\n        } else {\n            combined.push({\n                dlabel: listItem.dlabel,\n                stack: listItem.stack,\n                value: listItem.value\n            });\n        }\n    }\n    return combined;\n}\n\nexport function combineDataByLabel(flattenList) {\n    let combined = [];\n    for (let index = 0; index < flattenList.length; index++) {\n        let listItem = flattenList[index];\n        let entry = combined.find(function (entryItem) {\n            return entryItem.dlabel === listItem.dlabel;\n        });\n        if (entry) {\n            entry.value += listItem.value;\n        } else {\n            combined.push({\n                dlabel: listItem.dlabel,\n                stack: listItem.stack,\n                value: listItem.value\n            });\n        }\n    }\n    return combined;\n}\n","import {Component} from '../components/component';\nimport {GeoJson} from '../geojson/geojson';\nimport {colorsForStack} from '../shared/colors';\nimport {combine, combineDataByLabel, flatArrayOfArrays, flattenDatasets} from '../shared/auxiliary';\n\n/**\n * A component which renders a geo json with d3.\n *\n * @class MapChart\n * @extends Component\n */\nexport class MapChart extends Component {\n\n  /**\n   * Creates a new instance of MapChart.\n   *\n   * @param parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n    this.element = parent\n      .append('div')\n      .attr('id', this.selector);\n\n    this.initialize();\n    this.initializeProjection();\n    this.initializePath();\n\n    this.renderSVG();\n    this.renderMapBackground();\n    this.renderTooltipContainer();\n    this.renderLegend();\n  }\n\n  // MARK: - Initialize\n\n  /**\n   * Initialize with default values.\n   */\n  initialize() {\n    this.width = 1000;\n    this.height = 1000;\n\n    this.tintColor = 'blue';\n    this.backgroundColor = 'gray';\n    this.backgroundOpacity = 0.2;\n\n    this.isDrawsBackground = true;\n    this.isZoomable = true;\n    this.isShowLabels = true;\n\n    this.datasets = [];\n    this.geoJSON = null;\n    this.departmentsData = [];\n    this.excludedFeatureCodes = [\n      '2A', '2B'\n    ];\n  }\n\n  /**\n   * Initializes a mercator projection.\n   */\n  initializeProjection() {\n    this.projection = d3.geoMercator(); //.geoAlbers().rotate(30);\n  }\n\n  /**\n   * Initializes a geo path.\n   */\n  initializePath() {\n    this.path = d3.geoPath().projection(this.projection);\n  }\n\n\n  // MARK: - Render\n\n  /**\n   *\n   */\n  renderSVG() {\n    this.svg = d3\n      .select(`#${this.selector}`)\n      .append('svg')\n      .attr('id', 'map')\n      .classed('map', true)\n      .attr('viewBox', `0 0 ${this.width} ${this.height}`);\n\n    // .call(d3.zoom().on('zoom', function (event) {\n    //     if (!this.isZoomable) return;\n    //     this.svg.selectAll('path').attr('transform', event.transform);\n    //     this.svg.selectAll('text').attr('transform', event.transform);\n    // }.bind(this)));\n  }\n\n  /**\n   * Appends a rectangle to the svg which can be used as background.\n   */\n  renderMapBackground() {\n    this.background = this.svg\n      .append('rect')\n      .attr('width', this.width)\n      .attr('height', this.height)\n      .attr('fill', this.backgroundColor)\n      .attr('fill-opacity', function () {\n        return this.isDrawsBackground ? this.backgroundOpacity : 0;\n      }.bind(this));\n  }\n\n  /**\n   * Appends a division to the svg.\n   */\n  renderTooltipContainer() {\n    let color = this.tintColor;\n    this.tooltip = this.element\n      .append('div')\n      .attr('class', 'map-tooltip')\n      .attr('rx', 5) // corner radius\n      .attr('ry', 5)\n      .style('position', 'absolute')\n      .style('color', 'black')\n      .style('border', function () {\n        return `solid 1px ${color}`;\n      })\n      .style('opacity', 0);\n\n    this.bounds = this.svg\n      .append('rect')\n      .attr('class', 'bounds')\n      .style('position', 'absolute')\n      .style('pointer-events', 'none')\n      .style('fill-opacity', 0)\n      .style('stroke', 'red')\n      .style('stroke-width', '0.7px')\n      .style('stroke-dasharray', '1,1');\n  }\n\n  renderLegend() {\n    this.legend = this.svg\n      .append('svg')\n      .attr('class', 'legend')\n      .attr('fill', 'red')\n      .attr('width', this.width)\n      .attr('height', 200)\n      .attr('x', 0)\n      .attr('y', 0);\n  }\n\n\n  // MARK: - Render\n\n  /**\n   * Renders the `geoJSON` property.\n   */\n  renderGeoJson() {\n    let geoJSON = this.geoJSON;\n    let projection = this.projection;\n\n    // precalculate the center of each feature\n    geoJSON.features.forEach(function (feature) {\n      feature.center = d3.geoCentroid(feature);\n      let code = feature.properties.code;\n      if (!this.departmentsData || !this.departmentsData.length) return;\n      feature.departmentsData = this.departmentsData.find(dataset => +dataset.departmentNumber === +code);\n    }.bind(this));\n\n    let max = d3.max(this.departmentsData, data => data.value);\n    let tooltip = this.tooltip;\n    let boundsRectangle = this.bounds;\n    let tooltipWidth = String(this.tooltip.style('width') || 210).replace('px', '');\n    let tintColor = this.tintColor;\n    let thisReference = this;\n\n    this.svg\n      .selectAll('path')\n      .data(geoJSON.features)\n      .enter()\n      .append('path')\n      .attr('d', this.path)\n      .attr('id', feature => feature.properties.code)\n      .attr('fill', 'white')\n      .attr('fill-opacity', 0.5)\n      .attr('stroke', 'black')\n      .attr('stroke-width', '0.7')\n      .attr('stroke-dasharray', function (feature) {\n        return feature.departmentsData ? '0' : '1,4';\n      }.bind(this))\n      .attr('cursor', 'pointer')\n      .on('click', function (event, feature) {\n        // this.zoomTo(feature);\n      }.bind(this))\n      .on('mouseenter', function (event, feature) {\n        d3.select(this)\n          .attr('stroke', () => tintColor)\n          .attr('stroke-width', '2')\n          .attr('stroke-dasharray', '0');\n\n\n        // set tooltip content\n        let properties = feature.properties;\n        if (!properties) return;\n\n        let code = properties.code;\n        let propertiesSelection = Object.keys(properties);\n        let components = propertiesSelection.map(function (propertyName) {\n          return `${propertyName.capitalize()}: ${properties[propertyName]}`;\n        });\n\n        let flatData = flattenDatasets(thisReference.datasets);\n        let data = flatData.filter(item => +item.dlabel === +code);\n\n        if (data) {\n          for (let index = 0; index < data.length; index++) {\n            let item = data[index];\n            components.push(item.datasetName + ': ' + item.value);\n          }\n        }\n\n        tooltip.html(components.join('<br>'));\n\n\n        // position tooltip\n        let tooltipWidth = Number(tooltip.style('width').replace('px', '') || 200);\n        let tooltipHeight = Number(tooltip.style('height').replace('px', ''));\n        tooltipWidth += 20;\n        tooltipHeight += 20;\n\n        let featureBounds = d3.geoBounds(feature);\n        let featureLowerLeft = projection(featureBounds[0]);\n        let featureUpperRight = projection(featureBounds[1]);\n        let featureBoundsWidth = featureUpperRight[0] - featureLowerLeft[0];\n        let featureBoundsHeight = featureLowerLeft[1] - featureUpperRight[1];\n\n        // svg is presented in dynamic sized view box so we need to get the actual size\n        // of the element in order to calculate a scale for the position of the tooltip.\n        let effectiveSize = thisReference.getElementEffectiveSize();\n        let widthFactor = effectiveSize[0] / thisReference.width;\n        let heightFactor = effectiveSize[1] / thisReference.height;\n\n        // calculate offset\n        let positionOffset = thisReference.getElementPosition();\n\n        // calculate scaled position\n        let top = 0;\n\n        if ((featureLowerLeft[1] * heightFactor) > (effectiveSize[1] / 2)) {\n          top = featureUpperRight[1];\n          top *= widthFactor;\n          top -= tooltipHeight;\n          top -= 5;\n        } else {\n          top = featureLowerLeft[1];\n          top *= widthFactor; // Use width factor instead of heightFactor for propert using. Can't figure out why width factor works better.\n          top += 5;\n        }\n\n        top += positionOffset[1];\n\n        // calculate tooltip center\n        let centerBottom = featureLowerLeft[0];\n        centerBottom += (featureBoundsWidth / 2);\n        centerBottom *= widthFactor;\n        centerBottom -= (Number(tooltipWidth) / 2);\n        centerBottom += positionOffset[0];\n\n        tooltip.style('opacity', 1)\n          .style('left', centerBottom + 'px')\n          .style('top', top + 'px');\n\n        boundsRectangle\n          .style('opacity', 1)\n          .style('width', featureBoundsWidth + 'px')\n          .style('height', featureBoundsHeight + 'px')\n          .style('x', featureLowerLeft[0])\n          .style('y', featureUpperRight[1]);\n\n      })\n      .on('mouseout', function (event, feature) {\n        d3.select(this)\n          .attr('stroke', 'black')\n          .attr('stroke-width', '0.7')\n          .attr('stroke-dasharray', function (feature) {\n            return feature.departmentsData ? '0' : '1,4';\n          });\n        tooltip.style('opacity', 0);\n        boundsRectangle.style('opacity', 0);\n      });\n  }\n\n  /**\n   *\n   */\n  renderDatasets() {\n    if (!this.geoJSON) return;\n    if (!this.datasets) return;\n\n    let stackNames = this.getStackNames();\n    let flatData = flattenDatasets(this.datasets);\n    let combinedData = combineDataByLabel(flatData);\n    let color = colorsForStack(0, 1)[0];\n\n    // reset colors\n    this.svg\n      .selectAll('path')\n      .attr('fill', 'white')\n      .attr('fill-opacity', '.5');\n\n    for (let index = 0; index < stackNames.length; index++) {\n      let stackName = stackNames[index];\n      let dataForStack = combinedData.filter(data => data.stack === stackName);\n      let max = d3.max(dataForStack, item => item.value);\n      let color = colorsForStack(index, 1)[0];\n\n      for (let index = 0; index < dataForStack.length; index++) {\n        let datasetEntry = dataForStack[index];\n        let id = +datasetEntry.dlabel;\n        this.svg\n          .selectAll('path')\n          .filter(item => +item.properties.code === id)\n          .attr('fill', color.rgbString())\n          .attr('fill-opacity', datasetEntry.value / max);\n      }\n    }\n  }\n\n  renderDatasetLabels() {\n    if (!this.geoJSON) return;\n    if (!this.datasets) return;\n\n    let geoJSON = this.geoJSON;\n    let datasetsFlatten = flattenDatasets(this.datasets);\n    let combinedData = combineDataByLabel(datasetsFlatten);\n\n    this.svg.selectAll('.map-label').remove();\n    this.svg\n      .selectAll('text')\n      .data(geoJSON.features)\n      .enter()\n      .append('text')\n      .attr('class', 'map-label')\n      .attr('text-anchor', 'middle')\n      .attr('fill', this.tintColor)\n      .attr('font-size', 12)\n      .attr('opacity', function () {\n        return this.isShowLabels ? 1 : 0;\n      }.bind(this))\n      .text(function (feature) {\n        let code = +feature.properties.code;\n        let dataset = combinedData.find(dataset => +dataset.dlabel === code);\n        return dataset ? dataset.value : '';\n      })\n      .attr('x', function (feature) {\n        return this.projection(feature.center)[0];\n      }.bind(this))\n      .attr('y', function (feature) {\n        return this.projection(feature.center)[1];\n      }.bind(this));\n  }\n\n  /**\n   *\n   */\n  renderDatasetsLegend() {\n    if (!this.datasets) return;\n\n    let stackNames = this.getStackNames();\n    let flatData = flattenDatasets(this.datasets);\n    let combinedData = combine(flatData);\n\n    this.legend.raise();\n    this.legend.selectAll('rect').remove();\n    this.legend.selectAll('text').remove();\n\n    for (let index = 0; index < stackNames.length; index++) {\n\n      let stackName = stackNames[index];\n      let dataForStack = combinedData.filter(data => data.stack === stackName);\n      let max = d3.max(dataForStack, item => item.value);\n      let offset = index * 80;\n      let color = colorsForStack(index, 1)[0];\n\n      let steps = 4;\n      let data = [0, 1, 2, 3, 4];\n\n      this.legend\n        .append('text')\n        .attr('x', offset + 20)\n        .attr('y', '14')\n        .style('fill', color.rgbString())\n        .text(stackName);\n\n      this.legend\n        .append(\"g\")\n        .selectAll(\"rect\")\n        .data(data)\n        .enter()\n        .append(\"rect\")\n        .style('fill', color.rgbString())\n        .attr('x', '20')\n        .attr('y', '20')\n        .attr('width', 18)\n        .attr('height', 18)\n        .attr('transform', function (d, i) {\n          return 'translate(' + offset + ',' + (i * 20) + ')';\n        })\n        .style('stroke', 'black')\n        .style('stroke-width', 1)\n        .style('fill-opacity', (d, i) => i / steps);\n\n      this.legend\n        .append(\"g\")\n        .selectAll(\"text\")\n        .data(data)\n        .enter()\n        .append(\"text\")\n        .style('fill', color.rgbString())\n        .attr('x', '40')\n        .attr('y', '35')\n        .attr('width', 18)\n        .attr('height', 18)\n        .attr('transform', function (d, i) {\n          return 'translate(' + offset + ',' + (i * 20) + ')';\n        })\n        .style('stroke', 'black')\n        .style('stroke-width', 1)\n        .style('fill-opacity', (d, i) => i / steps)\n        .text(function (d, i) {\n          return ((i / steps) * max);\n        });\n    }\n  }\n\n  /**\n   * Sets the size of the projection to fit the given geo json.\n   *\n   * @param geoJSON\n   */\n  zoomTo(geoJSON) {\n    this.projection.fitSize([this.width, this.height], geoJSON);\n  }\n\n  /**\n   * Returns an array of strings containing the names of stacks in the datasets.\n   *\n   * @returns {string[]}\n   */\n  getStackNames() {\n    if (!this.datasets) return [];\n    let stackNames = this.datasets.map(dataset => String(dataset.stack));\n    return Array.from(new Set(stackNames));\n  }\n\n  /**\n   * Tells the receiving map chart to update its view.\n   */\n  update() {\n    this.geoJSONDidChange();\n    this.datasetsDidChange();\n  }\n\n\n  // MARK: - Load JSON\n\n  /**\n   * Loads the geo json at the given url into the map.\n   */\n  loadGeoJSON(geoJSONURL) {\n    d3.json(geoJSONURL)\n      .then(function (rawJSON) {\n        this.setGeoJSON(new GeoJson(rawJSON));\n      }.bind(this))\n      .catch(function (error) {\n        console.log(error);\n      }.bind(this));\n  }\n\n  /**\n   *\n   * @param newGeoJSON\n   */\n  setGeoJSON(newGeoJSON) {\n    this.geoJSON = newGeoJSON;\n    this.geoJSONDidChange();\n    this.tooltip.raise();\n  }\n\n  /**\n   *\n   * @param newDatasets\n   */\n  setDatasets(newDatasets) {\n    this.datasets = newDatasets;\n    this.datasetsDidChange();\n    this.tooltip.raise();\n    this.bounds.raise();\n  }\n\n  /**\n   * Tells the receiving map chart that its `geoJSON` property did change.\n   */\n  geoJSONDidChange() {\n    if (!this.geoJSON) return;\n    this.removeExcludedFeatures();\n    this.zoomTo(this.geoJSON);\n    this.renderGeoJson();\n    this.renderDatasets();\n  }\n\n  /**\n   * Tells the receiving map chartt that its `datasets` property did change.\n   */\n  datasetsDidChange() {\n    if (!this.datasets) return;\n    this.renderDatasets();\n    this.renderDatasetLabels();\n    this.renderDatasetsLegend();\n  }\n\n\n  // MARK: - Auxiliary\n\n  getElementEffectiveSize() {\n    let width = this.element.style('width').replace('px', '');\n    let height = this.element.style('height').replace('px', '');\n    return [Number(width), Number(height)];\n  }\n\n  getElementPosition() {\n    let element = document.getElementById(this.selector);\n    let rect = element.getBoundingClientRect();\n    let xPosition = rect.x + window.scrollX;\n    let yPosition = rect.y + window.scrollY;\n    return [xPosition, yPosition];\n  }\n\n  removeExcludedFeatures() {\n    if (!this.geoJSON) return;\n    let excludedFeatureCodes = this.excludedFeatureCodes;\n    for (let index = 0; index < excludedFeatureCodes.length; index++) {\n      let code = excludedFeatureCodes[index];\n      let candidate = this.geoJSON.features.find(feature => feature.properties.code === code);\n      if (!candidate) return;\n      let candidateIndex = this.geoJSON.features.indexOf(candidate);\n      if (candidateIndex < 0) return;\n      this.geoJSON.features.splice(candidateIndex, 1);\n    }\n  }\n}\n\n","import {Component} from \"./component\";\n\n/**\n *\n * @class Slider\n * @extends Component\n */\nexport class Slider extends Component {\n\n  constructor(parent) {\n    super(parent);\n    this.element = this.parent\n      .append('div')\n      .attr('id', this.selector)\n      .classed('range-container', true);\n    this.renderMinLabel();\n    this.render();\n    this.renderMaxLabel();\n    this.renderValueLabel();\n  }\n\n  renderMinLabel() {\n    this.minLabel = this.element\n      .append('label')\n      .attr('id', this.selector + '-min-label');\n  }\n\n  render() {\n    this.range = this.element\n      .append('input')\n      .attr('type', 'range')\n      .attr('name', 'mySlider')\n      .attr('min', '0')\n      .attr('max', '100')\n      .on('input', function (event) {\n        if (!event.target || event.target.value) return;\n        this.valueLabel.text(event.target.value);\n      }.bind(this));\n  }\n\n  renderMaxLabel() {\n    this.maxLabel = this.element\n      .append('label')\n      .attr('id', this.selector + '-max-label');\n  }\n\n  renderValueLabel() {\n    this.valueLabel = this.element\n      .append('label')\n      .classed('range-value-label', true);\n  }\n\n  get value() {\n    return d3.select(this.range).attr('value');\n  }\n\n  set value(newValue) {\n    this.range.attr('value', newValue);\n    this.valueLabel.text(newValue);\n  }\n\n  set minimum(newMin) {\n    this.range.attr('min', newMin);\n    this.minLabel.text(newMin);\n  }\n\n  set maximum(newMax) {\n    this.range.attr('max', newMax);\n    this.maxLabel.text(newMax);\n  }\n}\n","import {Popup} from \"../components/popup\";\nimport {Language} from \"../language/language\";\nimport {Checkbox} from \"../components/checkbox\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Option} from \"../components/option\";\n\n/**\n *\n * @class MapChartSettingsPopup\n * @extends Popup\n */\nexport class MapChartSettingsPopup extends Popup {\n\n  /**\n   *\n   */\n  render() {\n    this.card\n      .headerRow\n      .append('h3')\n      .text(Language.translate('Settings'));\n\n    this.row = this.card.body\n      .append('div')\n      .classed('row', true);\n\n    this.renderShowLabelsCheckbox();\n  }\n\n  /**\n   *\n   */\n  renderShowLabelsCheckbox() {\n    let container = this.row.append('div').classed('col-12 margin-top', true);\n    this.showLabelsCheckbox = new Checkbox(container);\n    this.showLabelsCheckbox.setText(Language.translate('Labels'));\n    this.showLabelsCheckbox.onClick = function (checked) {\n      this.mapChart.isShowLabels = checked;\n      this.mapChart.update();\n      URLParameters.getInstance().setWithoutDeleting('map-show-labels', checked);\n    }.bind(this);\n  }\n\n  /**\n   *\n   * @returns {{width: number, height: number}}\n   */\n  preferredSize() {\n    return {\n      width: 240,\n      height: 600\n    };\n  }\n\n  /**\n   *\n   */\n  willShow() {\n    super.willShow();\n    this.loadValues();\n  }\n\n  /**\n   *\n   */\n  loadValues() {\n    this.showLabelsCheckbox.setChecked(this.mapChart.isShowLabels);\n    console.log('this.mapChart.showLabels: ' + this.mapChart.isShowLabels);\n  }\n}\n","import {Card} from \"../components/card\";\nimport {Button} from \"../components/button\";\nimport {MapChart} from \"./map-chart\";\nimport {Slider} from \"../components/slider\";\nimport {screenshotElement} from \"../shared/screenshot\";\nimport {MapChartSettingsPopup} from \"./map-chart-settings-popup\";\n\n/**\n *\n * @class MapChartCard\n * @extends Card\n */\nexport class MapChartCard extends Card {\n\n  /**\n   * Creates a new instance of MapChartCard.\n   *\n   * @param parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n    this.renderMenuItems();\n    this.renderMapChart();\n  }\n\n  /**\n   *\n   */\n  renderSlider() {\n    this.slider = new Slider(this.headerCenterComponent);\n    this.slider.minimum = 1995;\n    this.slider.maximum = 2020;\n    this.slider.value = 2000;\n  }\n\n  /**\n   *\n   */\n  renderMenuItems() {\n    this.screenshotButton = new Button(this.headerRightComponent);\n    this.screenshotButton.setText('Screenshot');\n    this.screenshotButton.element.classed('simple-button', true);\n    this.screenshotButton.setFontAwesomeImage('camera');\n    this.screenshotButton.onClick = this.screenshotButtonAction.bind(this);\n\n    this.moreButton = new Button(this.headerRightComponent);\n    this.moreButton.setText('More');\n    this.moreButton.element.classed('simple-button', true);\n    this.moreButton.setFontAwesomeImage('ellipsis-h');\n    this.moreButton.onClick = this.presentSettingsPopupAction.bind(this);\n\n  }\n\n  /**\n   *\n   */\n  renderMapChart() {\n    this.mapChart = new MapChart(this.body);\n    this.mapChart.loadGeoJSON('/assets/Departements-Simple.geojson');\n  }\n\n\n  // MARK: - Actions\n\n  /**\n   * Triggered when the screenshot button is pushed.\n   */\n  screenshotButtonAction() {\n    let name = 'my_image.jpg';\n    let chartID = this.mapChart.selector;\n    screenshotElement(\"#\" + chartID, name);\n  }\n\n  /**\n   * Triggered when the more button is pushed.\n   */\n  presentSettingsPopupAction() {\n    let application = window.frcvApp;\n    let button = document.getElementById(this.moreButton.selector);\n    let settingsPopup = new MapChartSettingsPopup(application.element);\n    settingsPopup.mapChart = this.mapChart;\n    settingsPopup.showUnder(button, 'right');\n  }\n}\n","import {Popup} from \"../components/popup\";\nimport {Language} from \"../language/language\";\nimport {Checkbox} from \"../components/checkbox\";\nimport {URLParameters} from \"../shared/url-parameters\";\n\n/**\n *\n * @class TrackPopup\n * @extends Popup\n */\nexport class TrackPopup extends Popup {\n\n    /**\n     *\n     */\n    render() {\n        super.render();\n        this.renderHeadline();\n        this.renderRow();\n\n        this.renderTrackContentContainer();\n    }\n\n    renderHeadline() {\n        this.card\n            .headerRow\n            .append('h3')\n            .text(Language.translate('Track'));\n    }\n\n    renderRow() {\n        this.row = this.card.body\n            .append('div')\n            .classed('row', true);\n    }\n\n    renderTrackContentContainer() {\n        this.lyricsContainer = this.row\n            .append('div')\n            .classed('col-12', true)\n            .append('p');\n    }\n\n    update() {\n        if (!this.track) return;\n        let input = this.searchWord;\n        // let content = this.track.components.map(function (word) {\n        //     if (word.toLowerCase() === input.toLowerCase()) {\n        //         return `<b class=\"important\">${word}</b>`\n        //     } else {\n        //         return word\n        //     }\n        // }).join(' ');\n        let content = String(this.track.content);\n        let lines = content.split('\\n');\n        let html = '';\n        for (let i = 0; i < lines.length; i++) {\n            let line = lines[i];\n            let words = line.split(' ');\n            for (let j = 0; j < words.length; j++) {\n                let word = words[j];\n                if (word.toLowerCase() === input.toLowerCase()) {\n                    html += `<b class=\"important\">${word}</b>`;\n                } else if (word.toLowerCase() === `${input},`.toLowerCase()) {\n                    html += `<b class=\"important\">${word}</b>`;\n                } else {\n                    html += word;\n                }\n                html += ' ';\n            }\n            html += '<br>';\n        }\n\n        this.lyricsContainer.html(html);\n    }\n\n    /**\n     *\n     * @returns {{width: number, height: number}}\n     */\n    preferredSize() {\n        return {\n            width: 800,\n            height: 600\n        };\n    }\n}\n","import {Card} from \"../components/card\";\nimport {TrackPopup} from \"./track-popup\";\n\n/**\n *\n * @class WordAboutCard\n * @extends Card\n */\nexport class WordAboutCard extends Card {\n\n  /**\n   * Creates a new instance of WordAboutCard.\n   *\n   * @param parent The parental component.\n   */\n  constructor(parent) {\n    super(parent);\n  }\n\n  update() {\n    this.body.html('');\n    if (!this.datasets) return;\n\n    this.divs = this.body\n      .selectAll('div')\n      .data(this.datasets)\n      .enter()\n      .append('div')\n      .html(function (dataset, index) {\n        let components = [];\n        if (index !== 0) {\n          components.push(`<br>`);\n        }\n        components.push(`<b class=\"larger\">`);\n        components.push(`${dataset.label}`);\n        components.push(` (${dataset.data.length} Tracks)`);\n        components.push(`</b>`);\n        return components.join('');\n      })\n      .selectAll(\"div\")\n      .data(function (dataset) {\n        dataset.data.forEach(item => item.dataset = dataset.label);\n        return dataset.data\n          .sort(function (item1, item2) {\n            return d3.descending(item1.releaseYear, item2.releaseYear);\n          });\n      })\n      .enter()\n      .append(\"div\")\n      .style('cursor', 'pointer')\n      .html(function (item) {\n        let components = [];\n        components.push(`<span class=\"primary\">${item.title}</span>`);\n        components.push(`<span class=\"secondary\">(by ${item.artist}, ${item.releaseYear})</span>`);\n        return `<li>${components.join(' ')}</li>`;\n      })\n      .on('click', function (event, item) {\n        let parent = window.frcvApp.element;\n        let popup = new TrackPopup(parent);\n\n        console.log(item);\n        popup.searchWord = item.dataset;\n        popup.track = item;\n        popup.update();\n        popup.showBigModal();\n      });\n  }\n}\n","\n/**\n *\n * @class DatasetCollection\n */\nexport class DatasetCollection extends Array {\n\n}\n","import {Page} from './page';\nimport {Button} from \"../components/button\";\nimport {SearchPageSettingsPopup} from \"./search-page-settings-popup\";\nimport {DiachronicChartCard} from \"../time-chart/diachronic-chart-card\";\nimport {SearchCard} from \"./search-card\";\nimport {RecentSearches} from \"../shared/recent-searches\";\nimport {URLParameters} from \"../shared/url-parameters\";\nimport {Language} from \"../language/language\";\nimport {randomColor} from \"../shared/colors\";\nimport {MapChartCard} from \"../map-chart/map-chart-card\";\nimport {WordAboutCard} from \"./word-about-card\";\nimport {DatasetCollection} from \"../data-model/dataset-collection\";\n\n/**\n *\n * @class SearchPage\n * @extends Page\n */\nexport class SearchPage extends Page {\n\n    /**\n     *\n     * @param application\n     */\n    constructor(application) {\n        super(application, Language.translate('Search'));\n        application.makeContainerFull();\n\n        this.renderSettingsButton();\n\n        this.renderSearchInputCard();\n        this.renderDiachronicChart();\n        this.renderMapChart();\n        this.renderWordAboutCard();\n\n        this.loadCorpusIfNeeded();\n        this.applyURLParameters();\n    }\n\n\n    // MARK: - Render\n\n    renderSettingsButton() {\n        this.settingsButton = new Button(this.rightHeaderContainer);\n        this.settingsButton.setText(Language.translate('Settings'));\n        this.settingsButton.element.classed('simple-button button-down', true);\n        let thisReference = this;\n        this.settingsButton.onClick = function (event) {\n            if (!event || !event.target) return;\n            let settingsPopup = new SearchPageSettingsPopup(thisReference.application.element);\n            settingsPopup.searchPage = thisReference;\n            settingsPopup.showUnder(event.target, 'right');\n        };\n    }\n\n    renderSearchInputCard() {\n        this.searchCardContainer = this.addContainer(this.row, 'col-12');\n        this.searchCard = new SearchCard(this.searchCardContainer);\n\n        let thisReference = this;\n        this.searchCard.startSearching = function () {\n            thisReference.startSearching();\n        };\n    }\n\n    renderDiachronicChart() {\n        this.diachronicChartCardContainer = this.addContainer(this.row, 'col-12 col-lg-6');\n        this.diachronicChartCard = new DiachronicChartCard(this.diachronicChartCardContainer, null);\n        this.diachronicChartCard.titleLabel.text(Language.translate('Chart'));\n        this.diachronicChart = this.diachronicChartCard.chart;\n        this.searchCard.diachronicChart = this.diachronicChart;\n        this.diachronicChart.margin = {top: 40, left: 40, bottom: 80, right: 40};\n        this.diachronicChartCard.footer.style('display', 'none');\n    }\n\n    renderMapChart() {\n        this.mapCardContainer = this.addContainer(this.row, 'col-12 col-lg-6');\n        this.mapChartCard = new MapChartCard(this.mapCardContainer);\n        this.mapChartCard.titleLabel.text(Language.translate('Map'));\n    }\n\n    renderWordAboutCard() {\n        this.wordAboutCardContainer = this.addContainer(this.row, 'col-12 col-lg-6');\n        this.wordAboutCard = new WordAboutCard(this.diachronicChartCardContainer);\n        this.wordAboutCard.titleLabel.text(Language.translate('Word About'));\n    }\n\n\n    // MARK: - Override Page\n\n    willLoadCorpus() {\n        super.willLoadCorpus();\n        this.loadingView = this.addLoadingView(this.row);\n        this.diachronicChartCardContainer.style('display', 'none');\n        this.mapCardContainer.style('display', 'none');\n    }\n\n    didLoadCorpus() {\n        super.didLoadCorpus();\n        this.loadingView.remove();\n        this.diachronicChartCardContainer.style('display', 'block');\n        this.mapCardContainer.style('display', 'block');\n        // this.mapChartCard.mapChart.setCorpus(this.application.corpus);\n\n\n        if (this.searchCard.getSearchText()) {\n            this.startSearching();\n        }\n    }\n\n\n    // MARK: - View Mode\n\n    useFullWidthMode() {\n        this.diachronicChartCardContainer\n            .classed('col-lg-12', true)\n            .classed('col-lg-6', false);\n        this.mapCardContainer\n            .classed('col-lg-12', true)\n            .classed('col-lg-6', false);\n        this.wordAboutCardContainer\n            .classed('col-lg-12', true)\n            .classed('col-lg-6', false);\n    }\n\n    useHalfWidthMode() {\n        this.diachronicChartCardContainer\n            .classed('col-lg-12', false)\n            .classed('col-lg-6', true);\n        this.mapCardContainer\n            .classed('col-lg-12', false)\n            .classed('col-lg-6', true);\n        this.wordAboutCardContainer\n            .classed('col-lg-12', false)\n            .classed('col-lg-6', true);\n    }\n\n    setViewMode(viewMode, save = false) {\n        this.viewMode = viewMode;\n        switch (viewMode) {\n            case 'full':\n                this.useFullWidthMode();\n                break;\n            case 'half':\n                this.useHalfWidthMode();\n                break;\n            default:\n                break;\n        }\n        if (save) {\n            localStorage.setItem(SearchPage.viewModeKey, viewMode);\n        }\n    }\n\n    applyURLParameters() {\n        let parameters = URLParameters.getInstance();\n        let searchText = parameters.getString(URLParameters.query);\n        let searchSensitivity = parameters.getString(URLParameters.searchSensitivity, 'case-insensitive');\n        let startYear = parameters.getString(URLParameters.startYear, '2000');\n        let endYear = parameters.getString(URLParameters.endYear, '2020');\n        let valueType = parameters.getString(URLParameters.valueType, 'relative');\n\n        this.searchCard.searchField.setText(searchText);\n        this.searchCard.sensitivityDropdown.setSelectedOption(searchSensitivity);\n        this.searchCard.yearStartDropdown.value = startYear;\n        this.searchCard.yearEndDropdown.value = endYear;\n        this.searchCard.valueType = valueType;\n        this.searchCard.valueRadioGroup.setSelectedOption(valueType);\n\n        let viewModeURL = URLParameters.getInstance().getString(URLParameters.searchViewMode);\n        let viewModeLocalStorage = localStorage.getItem(SearchPage.viewModeKey);\n\n        if (viewModeURL) {\n            this.setViewMode(viewModeURL);\n        } else if (viewModeLocalStorage) {\n            this.setViewMode(viewModeLocalStorage);\n        } else {\n            this.setViewMode('half');\n        }\n\n        let showChart = parameters.getBoolean('show-chart', true);\n        showChart ? this.showChart() : this.hideChart();\n        let showMap = parameters.getBoolean('show-map', true);\n        showMap ? this.showMap() : this.hideMap();\n    }\n\n    showChart() {\n        this.diachronicChartCard.element.style('display', 'block');\n    }\n\n    hideChart() {\n        this.diachronicChartCard.element.style('display', 'none');\n    }\n\n    showMap() {\n        this.mapChartCard.element.style('display', 'block');\n    }\n\n    hideMap() {\n        this.mapChartCard.element.style('display', 'none');\n    }\n\n    showWordAbout() {\n        this.wordAboutCard.element.style('display', 'block');\n    }\n\n    hideWordAbout() {\n        this.wordAboutCard.element.style('display', 'none');\n    }\n\n\n    // MARK: - Search\n\n    startSearching() {\n        if (!this.application.isCorpusLoaded()) return;\n\n        let searchText = this.searchCard.getSearchText();\n        let searchField = this.searchCard.searchField;\n\n        if (searchText === undefined) {\n            return console.log('search text undefined');\n        } else if (searchText.trim().length === 0) {\n            return console.log('search text too short');\n        }\n\n        RecentSearches.getInstance().append(searchText);\n        searchField.updateRecentSearches();\n\n        this.searchFor(searchText);\n    }\n\n    searchFor(searchQuery) {\n\n        // clean search query\n        let groups = searchQuery.split(';').map(value => value.trim());\n        groups = groups.map(group => group.split(',').map(word => word.trim()).join(','));\n        groups = groups.map(group => group.trim());\n        let searchTextFormatted = groups.join(';');\n\n        let localDatasets = [];\n        let mapDatasets = [];\n        let trackDatasets = new DatasetCollection();\n\n        for (let i = 0; i < groups.length; i++) {\n            let group = groups[i];\n            let words = group.split(',').map(value => value.trim());\n            let stack = words.join(\", \");\n\n            for (let j = 0; j < words.length; j++) {\n\n                let searchWord = words[j];\n                let datasetObject = this.datasetFor(searchWord);\n                let data = datasetObject.chartData;\n                let mapData = datasetObject.mapData;\n                let tracks = datasetObject.tracks;\n\n                let newDataset = {\n                    label: searchWord,\n                    stack: stack,\n                    data: data\n                };\n\n                if (this.searchCard.valueType === 'relative') {\n                    data.forEach(item => item.value = (item.value / item.yearTotal));\n                }\n\n                let mapDataset = {\n                    label: searchWord,\n                    stack: stack,\n                    data: mapData\n                };\n\n                localDatasets.push(newDataset);\n\n                mapDatasets.push(mapDataset);\n\n                trackDatasets.push({\n                    label: searchWord,\n                    stack: stack,\n                    data: tracks\n                });\n            }\n        }\n\n        this.diachronicChart.datasets = localDatasets;\n        this.diachronicChart.update();\n\n        this.mapChartCard.mapChart.datasets = mapDatasets;\n        this.mapChartCard.mapChart.update();\n\n        this.wordAboutCard.datasets = trackDatasets;\n        this.wordAboutCard.update();\n\n        URLParameters.getInstance().set(URLParameters.query, searchTextFormatted);\n    }\n\n    datasetFor(searchText) {\n        let sensitivity = this.searchCard.sensitivity;\n        let firstYear = this.searchCard.firstYear;\n        let lastYear = this.searchCard.lastYear;\n\n        let corpus = this.application.corpus;\n        let tracks = corpus.tracksForWord(searchText, sensitivity);\n\n        tracks = tracks.filter(function (track) {\n            return track.releaseYear >= firstYear\n                && track.releaseYear <= lastYear;\n        });\n\n        let mapData = corpus.getMapDataForTracks(tracks);\n        mapData.forEach((item) => item.datasetName = searchText);\n\n\n        // mapData.forEach((item) => item.stack = searchText);\n        // mapData.searchText = searchText;\n\n        let chartData = corpus.getChartDataForTracks(\n            tracks,\n            firstYear,\n            lastYear,\n            sensitivity\n        );\n\n        return {\n            mapData: mapData,\n            chartData: chartData,\n            searchText: searchText,\n            tracks: tracks\n        };\n    }\n\n    applyMapData(mapData) {\n        let color = randomColor();\n        for (let i = 0; i < mapData.length; i++) {\n            const entry = mapData[i];\n            const departementNumber = entry.departementNumber;\n            const numberOfLyrics = entry.value;\n            if (numberOfLyrics === 0) {\n                continue;\n            }\n            const departement = this.application.getDepartementForNumber(departementNumber);\n            this.mapChart.drawDepartement(departement, color, \"\" + numberOfLyrics);\n        }\n    }\n}\n\nSearchPage.viewModeKey = 'de.beuth.frc-visualization.SearchPageViewMode';\n","import {Page} from './page';\nimport {Language} from \"../language/language\";\n\n/**\n *\n */\nexport class CorpusDataPage extends Page {\n  constructor(application) {\n    super(application, Language.translate('Corpus Metadata'));\n    // this.buildSubpage();\n    this.createLeftPanel();\n    this.createCard();\n    this.loadCorpusIfNeeded();\n  }\n\n  willLoadCorpus() {\n    super.willLoadCorpus();\n    this.loadingView = this.addLoadingView(this.cardBody);\n  }\n\n  didLoadCorpus() {\n    super.didLoadCorpus();\n    this.loadingView.remove();\n    this.update();\n  }\n\n  createLeftPanel() {\n    this.leftPanel = this.addContainer(this.row, 'col-lg-3');\n    this.titleLabel = this.leftPanel\n      .append('h1')\n      .text(this.title);\n  }\n\n  createCard() {\n    this.wrapper = this.addContainer(this.row, 'col-lg-6 col-12');\n    this.card = this.addContainer(this.wrapper, 'card card-corpus-metadata');\n    this.cardBody = this.addContainer(this.card, 'card-body');\n    this.cardBodyRow = this.addRow(this.cardBody);\n  }\n\n  update() {\n    this.clearContent();\n    let corpus = this.application.corpus;\n    this.currentGroup = this.createGroup();\n    this.createLine('# Artists', corpus.artists.length);\n    this.createLine('# Female Artists', corpus.femaleArtists().length);\n    this.createLine('# Male Artists', corpus.maleArtists().length);\n    this.createLine('# Group Artists', corpus.groupArtists().length);\n    this.currentGroup = this.createGroup();\n    this.createLine('# Albums', corpus.allAlbums().length);\n    this.currentGroup = this.createGroup();\n    this.createLine('# Tracks w/o Album', corpus.allTracksWithoutAlbum().length);\n    this.createLine('# Tracks', corpus.allTracks().length);\n    this.currentGroup = this.createGroup();\n    this.createLine('# Words', corpus.allWords().length);\n  }\n\n  createGroup() {\n    return this.addContainer(this.cardBodyRow, 'group');\n  }\n\n  createLine(title, value) {\n    let row = this.currentGroup\n      .append('div')\n      .classed('row text-vertical-center', true);\n    row.append('div')\n      .classed('col-6 text-end label', true)\n      .text(appendColon(title));\n    row.append('div')\n      .classed('col-6', true)\n      .append('samp')\n      .text(value);\n  }\n\n  clearContent() {\n    this.cardBody.selectAll('div').remove();\n    this.cardBodyRow = this.addRow(this.cardBody);\n  }\n}\n\n/**\n * Appends a colon (':') to the given string if it does not end with one.\n *\n * @param text The string to append a colon on.\n * @returns {*|string} The text ending with a colon.\n */\nfunction appendColon(text) {\n  return text.endsWith(':') ? text : text + ':';\n}\n","import {Component} from \"./component\";\nimport {createUUID} from \"../shared/uuid\";\n\n/**\n * Displays a loading status.\n *\n * @class ProgressBar\n * @extends Component\n */\nexport class ProgressBar extends Component {\n\n  /**\n   * Creates a new instance of ProgressBar.\n   * @param parent\n   */\n  constructor(parent) {\n    super(parent);\n    this.renderBar();\n  }\n\n  /**\n   * Adds the bar to the parent.\n   */\n  renderBar() {\n    this.barContainerSelector = createUUID();\n    this.barContainer = this.parent\n      .append('div')\n      .attr('id', this.barContainerSelector)\n      .attr('class', 'progress-bar-container');\n    this.element = this.barContainer;\n\n    this.barSelector = createUUID();\n    this.bar = this.barContainer\n      .append('div')\n      .attr('id', this.barSelector)\n      .attr('class', 'progress-bar')\n      .html('&nbsp;');\n  }\n\n  set value(newValue) {\n    let valueAsNumber = Number(newValue);\n    let barContainer = document.getElementById(this.barContainerSelector);\n    let totalWidth = barContainer.getBoundingClientRect().width;\n    let totalWidthAsNumber = Number(totalWidth);\n    let width = (totalWidthAsNumber * valueAsNumber);\n    document.getElementById(this.barSelector)\n      .setAttribute('style', 'width:' + width + 'px');\n  }\n\n  get value() {\n    let totalWidth = document.getElementById(this.barContainerSelector).style.width;\n    let barWidth = document.getElementById(this.barSelector).style.width;\n    console.log('totalWidth: ' + totalWidth);\n  }\n}\n","import {Page} from './page';\nimport {Language} from \"../language/language\";\nimport {ProgressBar} from \"../components/progress-bar\";\n\n/**\n * The main page of the application.\n *\n * @class MainPage\n * @extends Page\n */\nexport class MainPage extends Page {\n\n  /**\n   * Creates a new instance.\n   *\n   * @param application\n   */\n  constructor(application) {\n    super(application, 'Main');\n    if (!application) {\n      throw 'No application given.';\n    }\n    this.application = application;\n    this.element = application.element;\n    this.renderLeftTitleComponent();\n    this.renderMenuCard();\n    this.renderMenuItems();\n    this.renderProgressBar();\n    this.hideBackButton();\n\n    this.updateFooterURL();\n    this.updateFooterDebugInfo();\n    this.loadData();\n  }\n\n  /**\n   *\n   */\n  renderLeftTitleComponent() {\n\n    this.titleContainer = this.row\n      .append('div')\n      .classed('col-lg-3', true);\n\n    let title = this.application.delegate.name;\n    this.titleLabel = this.titleContainer\n      .append('h1')\n      .text(title);\n\n    this.titleInfoBox = this.titleContainer\n      .append('div')\n      .classed('info-box', true);\n  }\n\n  renderMenuCard() {\n    this.menuCardContainer = this.row\n      .append('div')\n      .classed('col-6', true);\n    this.menuCard = this.menuCardContainer\n      .append('div')\n      .classed('card card-inset menu', true);\n  }\n\n  renderMenuItems() {\n    let application = this.application;\n    let pages = [\n      ['search', Language.translate('Search')],\n      ['diachronic-data', Language.translate('Diachronic Data')],\n      ['diatopic-data', Language.translate('Diatopic Data')],\n      ['corpus-data', Language.translate('Corpus Data')]\n    ];\n\n    for (let i = 0; i < pages.length; i++) {\n      let pageItem = pages[i];\n      let pageId = pageItem[0];\n      let pageTitle = pageItem[1];\n      this.addMenuButton(pageTitle, function () {\n        application.showPage(pageId, true);\n      });\n    }\n  }\n\n  addMenuButton(name, functionToCall) {\n    let link = this.menuCard\n      .append('a')\n      .text(name)\n      .on('click', function () {\n        if (!functionToCall)\n          return;\n        functionToCall();\n      });\n    this.menuCard.append('br');\n    return link;\n  }\n\n  renderProgressBar() {\n    this.progressBar = new ProgressBar(this.menuCardContainer);\n    this.progressBar.value = 0;\n  }\n\n  loadData() {\n    let delegate = this.application.delegate;\n    if (delegate.rawJSON) return;\n    let progressBar = this.progressBar;\n    delegate.loadData(function (progress, error) {\n      progressBar.value = progress;\n    }, function () {\n      progressBar.hide();\n    });\n  }\n}\n","import {Page} from './page';\nimport {DiachronicChartCard} from \"../time-chart/diachronic-chart-card\";\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Language} from \"../language/language\";\nimport {URLParameters} from \"../shared/url-parameters\";\n\n/**\n * An application page which presents information about the diachronic data of the corpus.\n *\n * @class DiachronicAboutPage\n * @extends Page\n */\nexport class DiachronicAboutPage extends Page {\n\n    /**\n     * Creates a new instance.\n     *\n     * @param application The main application.\n     */\n    constructor(application) {\n        super(application, Language.translate('Diachronic About'));\n        this.contentType = 'tracks';\n        this.buildSubpage();\n        this.renderDiachronicChart();\n        this.renderContentRadioGroup();\n        this.applyURLParameters();\n        this.loadCorpusIfNeeded();\n    }\n\n    /**\n     * Appends a chart wrapper and a chart cart containing the chart to the main row.\n     */\n    renderDiachronicChart() {\n        this.chartWrapper = this\n            .addContainer(this.row, 'col-12')\n            .append('div');\n\n        this.chartCard = new DiachronicChartCard(this.chartWrapper, 'Chart');\n        this.chart = this.chartCard.chart;\n        this.chartCard.chart.margin = {\n            top: 60, left: 50, bottom: 70, right: 50\n        };\n    }\n\n    /**\n     * Appends a radio group to specify the presentet content type.\n     */\n    renderContentRadioGroup() {\n        this.radioGroup = new RadioGroup(this.chartCard.headerCenterComponent);\n        this.radioGroup.setOptions([\n            ['tracks', Language.translate('Tracks')],\n            ['words', Language.translate('Words')],\n            ['words-relative', Language.translate('Words (Relative)')],\n            ['types', Language.translate('Types')],\n            ['types-relative', Language.translate('Types (Relative)')],\n        ]);\n\n        this.radioGroup.onChange = function (value) {\n            this.contentType = value;\n            this.update();\n        }.bind(this);\n    }\n\n    // MARK: - Override Page\n\n    willLoadCorpus() {\n        super.willLoadCorpus();\n        this.showLoadingView();\n    }\n\n    didLoadCorpus() {\n        super.didLoadCorpus();\n        this.hideLoadingView();\n        this.update();\n    }\n\n    applyURLParameters() {\n        this.contentType = URLParameters.getInstance().getString(\n            URLParameters.contentType, 'tracks');\n        this.radioGroup.setSelectedOption(this.contentType);\n    }\n\n    // MARK: - Funtions\n\n    update() {\n        let corpus = this.application.corpus;\n        if (!corpus) return;\n        this.setCorpus(corpus);\n    }\n\n    contentTypeDidChange() {\n\n    }\n\n    setCorpus(corpus) {\n        let yearCollection;\n        switch (this.contentType) {\n            case 'tracks':\n                yearCollection = corpus.getLyricsPerYear();\n                break;\n            case 'words':\n                yearCollection = corpus.getWordsPerYear();\n                break;\n            case 'words-relative':\n                yearCollection = corpus.getWordsPerYearRelative();\n                break;\n            case 'types':\n                yearCollection = corpus.getTypesPerYear();\n                break;\n            case 'types-relative':\n                yearCollection = corpus.getTypesPerYearRelative();\n                break;\n            case 'non-standard':\n                yearCollection = corpus.getTotalNonStandardPerYearCount();\n                break;\n            default:\n                yearCollection = [];\n                break;\n        }\n\n        URLParameters.getInstance().set(URLParameters.contentType, this.contentType);\n\n        let title = this.contentType.capitalize();\n        let dataset = {\n            label: title,\n            stack: title,\n            data: []\n        };\n\n        let firstYear = d3.min(Object.keys(yearCollection));\n        let lastYear = d3.max(Object.keys(yearCollection));\n\n        for (let year = firstYear; year <= lastYear; year++) {\n            dataset.data.push({\n                year: year,\n                value: yearCollection[year] || 0,\n                yearTotal: yearCollection[year] || 0\n            });\n        }\n\n        this.chart.datasets = [dataset];\n        this.chart.update();\n    }\n}\n\n// MARK: - Extension of String\n\nString.prototype.capitalize = function () {\n    return this.charAt(0).toUpperCase() + this.slice(1);\n};\n","import {Page} from './page';\nimport {RadioGroup} from \"../components/radio-group\";\nimport {Card} from \"../components/card\";\nimport {colorsForStack} from \"../shared/colors\";\n\n/**\n *\n * @class ArtistsDataPage\n * @extends Page\n */\nexport class ArtistsDataPage extends Page {\n\n    /**\n     *\n     * @param application\n     */\n    constructor(application) {\n        super(application, 'Artists Metadata');\n\n\n        this.buildSubpage();\n        this.createCard();\n        this.createContentTypeRadioGroup();\n        this.valueGettingFunction = this.numberOfTypes;\n\n        this.initialize();\n        this.renderSVG();\n        this.renderTooltip();\n\n        this.loadCorpusIfNeeded();\n    }\n\n    initialize() {\n        this.width = 1000;\n        this.margin = {top: 20, right: 70, bottom: 50, left: 180};\n        this.graphWidth = this.width - this.margin.left - this.margin.right;\n        this.lineHeight = 18;\n    }\n\n    renderSVG() {\n        this.chartView = this.card.content;\n        this.svg = this.chartView\n            .append(\"svg\");\n        this.graph = this.svg\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.margin.left + \",\" + this.margin.top + \")\");\n    }\n\n    renderTooltip() {\n        this.tooltip = this.card.content\n            .append(\"div\")\n            .attr(\"class\", \"tooltip map-tooltip\")\n            .style(\"position\", \"absolute\")\n            .style(\"border\", \"1px solid #69b3a2\")\n            .style(\"display\", \"none\");\n    }\n\n    buildVisual(data) {\n        const margin = this.margin;\n        const max = d3.max(data, (item) => item.value);\n        const colorString = colorsForStack(0, 1)[0].rgbString();\n\n        this.graphHeight = (this.lineHeight * data.length);\n        this.height = this.graphHeight + (margin.top + margin.bottom);\n\n        this.graph.selectAll('g').remove();\n        this.graph.selectAll('text').remove();\n        this.graph.selectAll('rect').remove();\n\n        this.svg.attr('viewBox', `0 0 ${this.width} ${this.height}`);\n\n        const x = d3.scaleLinear()\n            .domain([0, max])\n            .range([0, this.graphWidth]);\n\n        const y = d3.scaleBand()\n            .range([0, this.graphHeight])\n            .domain(data.map((item) => `${item.name} (${item.geniusId})`))\n            .padding(.1);\n\n        this.graph\n            .append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + this.graphHeight + \")\")\n            .call(d3.axisBottom(x))\n            .selectAll(\"text\")\n            .attr(\"transform\", \"translate(-10,0)rotate(-45)\")\n            .style(\"text-anchor\", \"end\");\n\n        this.graph\n            .append(\"g\")\n            .call(d3.axisLeft(y));\n\n        const barGroup = this.graph\n            .selectAll(\"chart-rect\")\n            .data(data)\n            .enter()\n            .append(\"rect\")\n            .classed(\"chart-rect\", true);\n\n        barGroup\n            .attr(\"x\", x(0))\n            .attr(\"y\", (item) => y(`${item.name} (${item.geniusId})`))\n            .attr(\"width\", (item) => x(item.value))\n            .attr(\"height\", y.bandwidth())\n            .attr(\"fill\", colorString)\n            .attr(\"rx\", \"4\")\n            .attr(\"ry\", this.lineHeight / 2);\n\n        barGroup\n            .on(\"mousemove\", function (event, item) {\n\n                this.tooltip\n                    .style(\"display\", \"inline-block\")\n                    .html('Value: ' + (item.value) + \"<br>Artist: \" + item.name);\n\n                let tooltipWidth = this.tooltip.style('width').replace('px', '');\n\n                let element = document.getElementById('content');\n                let offset = element.getBoundingClientRect();\n\n                let width = this.chartView.style('width').replace('px', '');\n                let ratio = width / 1000;\n                console.log('ratio: ' + ratio);\n\n                let xPos = x(item.value) / 2;\n                xPos += offset.x;\n                xPos *= ratio;\n                xPos += margin.left;\n                xPos += window.scrollX;\n                xPos -= tooltipWidth / 2;\n\n                let yPos = y(`${item.name} (${item.geniusId})`);\n                yPos += margin.top;\n                yPos *= ratio;\n                yPos += offset.y;\n                yPos += this.lineHeight;\n                yPos += window.scrollY;\n\n                this.tooltip\n                    .style(\"left\", xPos + \"px\")\n                    .style(\"top\", yPos + \"px\")\n                    .style(\"position\", \"absolute\")\n                    .style(\"border\", \"1px solid #69b3a2\")\n                    .style(\"display\", \"inline-block\")\n                    .html('Value: ' + (item.value) + \"<br>Artist: \" + item.name);\n            }.bind(this))\n            .on(\"mouseout\", function (d) {\n                this.tooltip.style(\"display\", \"none\");\n            }.bind(this));\n\n        this.graph\n            .selectAll(\".text\")\n            .data(data)\n            .enter()\n            .append('text')\n            .text((item) => item.value)\n            .attr(\"x\", (item) => x(item.value))\n            .attr(\"y\", (item) => y(`${item.name} (${item.geniusId})`))\n            .attr('dy', this.lineHeight - 6)\n            .attr('dx', '6')\n            .attr(\"width\", (item) => x(item.value))\n            .attr(\"height\", y.bandwidth())\n            .attr(\"font-size\", 13)\n            .attr('fill', 'gray');\n\n    }\n\n    /**\n     *\n     */\n    willLoadCorpus() {\n        super.willLoadCorpus();\n        this.loadingView = this.addLoadingView(this.card.body);\n    }\n\n    /**\n     *\n     */\n    didLoadCorpus() {\n        super.didLoadCorpus();\n        this.update();\n        this.loadingView.remove();\n    }\n\n    /**\n     *\n     */\n    createCard() {\n        this.cardContainer = this.addContainer(this.row, 'col-12');\n        this.card = new Card(this.cardContainer);\n    }\n\n    /**\n     *\n     */\n    createContentTypeRadioGroup() {\n\n        this.card.headerCenterComponent\n            .classed('text-center', true)\n            .append('div')\n            .attr('id', 'radio-group-2');\n\n        this.radioGroup = new RadioGroup(this.card.headerCenterComponent);\n        this.radioGroup.setOptions([\n            ['types', 'Types'],\n            ['words', 'Words'],\n            ['tracks', 'Tracks'],\n            ['albums', 'Albums']\n        ]);\n\n        this.radioGroup.onChange = function (value) {\n            this.chartTypeAction(value);\n        }.bind(this);\n    }\n\n    chartTypeAction(value) {\n        console.log(\"value: \" + value);\n        switch (value) {\n            case 'types':\n                this.valueGettingFunction = this.numberOfTypes;\n                break;\n            case 'words':\n                this.valueGettingFunction = this.numberOfWords;\n                break;\n            case 'tracks':\n                this.valueGettingFunction = this.numberOfTracks;\n                break;\n            case 'albums':\n                this.valueGettingFunction = this.numberOfAlbums;\n                break;\n            default:\n                console.log(\"unknown chart type: \" + value);\n                break;\n        }\n        this.update();\n    }\n\n    numberOfTypes(artist) {\n        return (new Set(artist.allWords())).size;\n    }\n\n    numberOfWords(artist) {\n        return artist.allWords().length;\n    }\n\n    numberOfTracks(artist) {\n        return artist.allTracks().length;\n    }\n\n    numberOfAlbums(artist) {\n        return artist.albums.length;\n    }\n\n    update() {\n        let corpus = this.application.corpus;\n        if (!corpus) return;\n\n        const root2 = d3.hierarchy(corpus.artists);\n        const artists = corpus.artists\n            .filter((artists) => artists.allTracks().length > 0)\n            .reverse();\n\n        let data = [];\n        for (let i = 0; i < artists.length; i++) {\n            let artist = artists[i];\n            let artistName = artist.name;\n            let value = this.valueGettingFunction(artist);\n            data.push({\n                name: artistName,\n                geniusId: artist.geniusId,\n                departement: artist.departement,\n                departementNo: artist.departementNo,\n                value: Number(value)\n            });\n        }\n\n        data = d3.sort(data, function (a, b) {\n            return b.value - a.value;\n        });\n\n        const countAll = data.length;\n        data = data.filter((item) => item.value > 0);\n\n        const countFiltered = data.length;\n        console.log(\"countAll: \" + countAll);\n        console.log(\"countFiltered: \" + countFiltered);\n        this.buildVisual(data);\n\n    }\n\n    buildHistogram(data) {\n        // const max = d3.max(data, (item: any) => item.value);\n        // const height = 500;\n        // const width = 1000;\n        // const margin = {top: 50, right: 50, bottom: 50, left: 50};\n        //\n        // const histogramView = d3.select(\".histogram\");\n        // histogramView.selectAll('svg').remove();\n        //\n        // const svg = histogramView\n        //     .append(\"svg\")\n        //     .attr(\"width\", width)\n        //     .attr(\"height\", height + margin.top + margin.bottom)\n        //     .append(\"g\")\n        //     .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n        //\n        // const x = d3.scaleLinear()\n        //     .domain([0, max])\n        //     .range([0, width]);\n        //\n        // svg.append(\"g\")\n        //     .attr(\"transform\", \"translate(0,\" + height + \")\")\n        //     .call(d3.axisBottom(x));\n        //\n        // const histogram = d3.histogram()\n        //     .value((item: any) => item.value)\n        //     .domain(this.x.domain())\n        //     .thresholds(x.ticks(50));\n        //\n        // const bins = histogram(data);\n        //\n        // const y = d3.scaleLinear()\n        //     .range([height, 0]);\n        //\n        // y.domain([0, d3.max(bins, function (d) {\n        //     // @ts-ignore\n        //     return d.length;\n        // })]);   // d3.hist has to be called before the Y axis obviously\n        //\n        // svg.append(\"g\")\n        //     .call(d3.axisLeft(y));\n        //\n        // svg.selectAll(\"myRect\")\n        //     .data(bins)\n        //     .enter()\n        //     .append(\"rect\")\n        //     .attr(\"x\", 1)\n        //     .attr(\"transform\", function (d: any) {\n        //         return \"translate(\" + x(d.x0) + \",\" + y(d.length) + \")\";\n        //     })\n        //     .attr(\"width\", (d: any) => Math.max(0, x(d.x1) - x(d.x0) - 1))\n        //     .attr(\"height\", function (d: any) {\n        //         return height - y(d.length);\n        //     })\n        //     .style(\"fill\", \"#69b3a2\");\n    }\n}\n","import {Page} from \"./page\";\nimport {Language} from \"../language/language\";\nimport {MapChartCard} from \"../map-chart/map-chart-card\";\nimport {URLParameters} from \"../shared/url-parameters\";\n\n/**\n *\n * @class LocationDataPage\n * @extends Page\n */\nexport class LocationDataPage extends Page {\n\n  constructor(application) {\n    let title = Language.translate('Location Data');\n    super(application, title);\n\n    this.buildSubpage();\n    this.applyURLParameters();\n    this.loadGeoJSONFromDelegate();\n    this.didLoadGeoJSONFromDelegate();\n  }\n\n  renderBody() {\n    super.renderBody();\n    this.mapChartContainer = this.row.append('div').classed('col-12', true);\n    this.mapChartCard = new MapChartCard(this.mapChartContainer);\n    this.mapChartCard.titleLabel.text(Language.translate('Map'));\n    this.mapChartCard.mapChart.isDrawsBackground = false;\n    this.mapChartCard.mapChart.isShowLabels = true;\n    this.mapChartCard.mapChart.isZoomable = false;\n  }\n\n  applyURLParameters() {\n    let parameters = URLParameters.getInstance();\n    let showLabels = parameters.getBoolean('map-show-labels', true);\n    this.mapChartCard.mapChart.isShowLabels = showLabels;\n    this.mapChartCard.mapChart.update();\n  }\n\n  loadGeoJSONFromDelegate() {\n    let url = this.application.delegate.geoJSON;\n    this.mapChartCard.mapChart.loadGeoJSON(url);\n  }\n\n  didLoadGeoJSONFromDelegate() {\n    let mapChart = this.mapChartCard.mapChart;\n    let corpus = this.application.corpus;\n    // let delegate = this.application.delegate;\n    // let departmentData = corpus.getDepartementsData();\n    // let data = [];\n    //\n    // departmentData.forEach(function (departmentData) {\n    //   data.push({\n    //     departmentName: departmentData.departmentName,\n    //     dlabel: departmentData.departmentNumber,\n    //     value: departmentData.value,\n    //   });\n    // });\n    //\n    // let dataset = {\n    //   dlabel: 'Total Lyrics',\n    //   stack: 'Total Lyrics',\n    //   data: data\n    // };\n    //\n    // mapChart.setDatasets([dataset]);\n  }\n}\n","\nexport class DataDelegate {\n\n  constructor() {\n  }\n}\n\n","import {DataDelegate} from \"./data-delegate\";\n\n/**\n * @class DefaultDataDelegate\n * @extends DataDelegate\n */\nexport class DefaultDataDelegate extends DataDelegate {\n\n  constructor() {\n    super();\n    this.name = 'Lotivis';\n  }\n}\n","import {SearchPage} from './pages/search-page';\nimport {CorpusDataPage} from './pages/corpus-data-page';\nimport {MainPage} from \"./pages/main-page\";\nimport {DiachronicAboutPage} from \"./pages/diachronic-about-page\";\nimport {ArtistsDataPage} from \"./pages/artists-data-page\";\nimport {URLParameters} from \"./shared/url-parameters\";\nimport {Language} from \"./language/language\";\nimport {LocationDataPage} from \"./pages/location-data-page\";\nimport {DataDelegate} from \"./data-source/data-delegate\";\nimport {DefaultDataDelegate} from \"./data-source/default-data-delegate\";\n\n/**\n *\n * @class Application\n */\nexport class Application {\n\n  /**\n   * Creates a new instance in the container with the given id.\n   *\n   * @param selector The id of the `div` element.\n   * @param delegate A data delegate which provides data for the app.\n   */\n  constructor(selector, delegate) {\n    if (!selector) throw 'No selector specified.';\n    if (!delegate) delegate = new DefaultDataDelegate();\n\n    this.selector = selector;\n    this.delegate = delegate;\n\n    this.willInitialize();\n    this.initialize();\n    this.didInitialize();\n  }\n\n\n  // MARK: - Life Cycle\n\n  willInitialize() {\n    // console.clear();\n  }\n\n  initialize() {\n    this.element = d3\n      .select(`#${this.selector}`)\n      .classed('container', true);\n    window.lotivisApplication = this;\n\n    let parameters = URLParameters.getInstance();\n    let language = parameters.getString(URLParameters.language, Language.English);\n    Language.setLanguage(language);\n  }\n\n  didInitialize() {\n    this.loadPage();\n  }\n\n  // MARK: - Load Page\n\n  clearContainer() {\n    document.getElementById(this.selector).innerHTML = '';\n  }\n\n  loadPage() {\n    let page = URLParameters.getInstance().getString(URLParameters.page, 'main');\n    this.showPage(page, false);\n  }\n\n  showPage(selector, updateHistory = false) {\n    this.clearContainer();\n    if (updateHistory) {\n      URLParameters.getInstance().clear();\n      URLParameters.getInstance().set(URLParameters.page, selector);\n      URLParameters.getInstance().set(URLParameters.language, Language.language);\n    }\n\n    this.currentPageSelector = selector;\n\n    switch (selector) {\n      case 'search':\n        this.currentPage = new SearchPage(this);\n        break;\n      case 'about':\n        this.currentPage = new AboutPage(this);\n        break;\n      case 'corpus-data':\n        this.currentPage = new CorpusDataPage(this);\n        break;\n      case 'artists-data':\n        this.currentPage = new ArtistsDataPage(this);\n        break;\n      case 'diachronic-data':\n        this.currentPage = new DiachronicAboutPage(this);\n        break;\n      case 'diatopic-data':\n        this.currentPage = new LocationDataPage(this);\n        break;\n      default:\n        this.currentPage = new MainPage(this);\n        this.currentPageSelector = 'main';\n        break;\n    }\n\n    console.log(this.currentPage);\n  }\n\n  /**\n   *\n   */\n  reloadPage() {\n    this.showPage(this.currentPageSelector);\n  }\n\n  /**\n   * Changes the class of the application element from 'container' to 'container-fluit'.\n   */\n  makeFluit() {\n    this.element.classed('container-fluit', true);\n    this.element.classed('container', false);\n  }\n\n  /**\n   * Changes the class of the application element from 'container-fluit' to 'container'.\n   */\n  makeUnfluit() {\n    this.element.classed('container-fluit', false);\n    this.element.classed('container', true);\n  }\n\n\n  // Corpus\n\n  isCorpusLoaded() {\n    return this.corpus !== undefined;\n  }\n\n  loadCorpus(completion) {\n    let thisReference = this;\n    this.isLoading = true;\n    let url = \"../../corpus/original\";\n    d3.json(url)\n      .then(function (json) {\n        // thisReference.corpus = new Corpus(json);\n        // thisReference.isLoading = false;\n        // thisReference.fetchDepartements(completion);\n      });\n  }\n\n  fetchDepartements(completion) {\n    let thisReference = this;\n    this.isFetchingDepartements = true;\n    fetch(\"../../departements\")\n      .then(response => response.json())\n      .then(function (json) {\n        thisReference.departements = json;\n        thisReference.corpus.departements = json;\n        thisReference.isFetchingDepartements = false;\n        if (completion) {\n          completion();\n        }\n      });\n  }\n\n  getDepartementForNumber(departementNumber) {\n    for (let i = 0; i < this.departements.length; i++) {\n      const departement = this.departements[i];\n      if (departementNumber === departement.deptCode) {\n        return departement;\n      }\n    }\n\n    return null;\n  }\n\n  makeContainerNormal() {\n    this.element.classed('container-full', false);\n    this.element.classed('container', true);\n  }\n\n  makeContainerFull() {\n    this.element.classed('container', false);\n    this.element.classed('container-full', true);\n  }\n}\n\nclass MenuItem {\n\n}\n\nApplication.Pages = {};\n\nexports.DataDelegate = DataDelegate;\n"],"names":["createUUID","usedIDs","generate","replace","c","r","Math","random","toString","uuid","indexOf","Component","[object Object]","parent","this","selector","element","style","isVisible","Button","super","thisRef","append","attr","on","event","onClick","text","imageName","html","URLParameters","instance","URL","window","location","href","parameter","defaultValue","value","getURL","searchParams","get","newValue","url","delete","set","history","replaceState","updateCurrentPageFooter","newPath","protocol","host","newURL","console","log","lotivisApplication","currentPage","updateFooter","language","page","query","searchViewMode","chartType","chartShowLabels","chartCombineStacks","contentType","valueType","searchSensitivity","startYear","endYear","showTestData","Strings","greeting","French Rap Corpus Visualization","Version","Server","Search","Diachronic Data","Diatopic Data","Corpus Data","Artists Data","About the Project","Click on URL to copy it to clipboard","Tracks","Words","Words (Relative)","Types","Types (Relative)","true","false","Back","Loading...","Settings","Chart","Close","Half","Full","from","till","Relative","Absolute","Innovation List","View Mode","Map","Impress","Privacy Policy","Corpus loaded status","Language","Diachronic About","Corpus Metadata","Artists Metadata","About","English","German","French","strings","Strings_en_EN","setLanguage","Strings_de_DE","Strings_fr_FR","translate","string","repeat","length","RadioGroup","inputElements","classed","optionId","optionName","inputElement","thisReference","options","removeOptions","i","id","name","translatedTitle","addOption","push","selectedOption","selectAll","remove","target","onChange","Card","createHeader","createBody","createFooter","header","headerRow","headerLeftComponent","headerCenterComponent","headerRightComponent","titleLabel","body","content","footer","footerRow","footerLeftComponent","footerRightComponent","Popup","renderUnderground","renderContainer","renderCard","render","renderCloseButton","addCloseActionListeners","modalBackgroundId","modalBackground","elementId","card","closeButton","setText","validIDs","popup","includes","dismiss","willShow","getUnderground","display","didShow","willDismiss","willRemoveDOMElement","document","getElementById","sourceElement","position","preferredSize","origin","calculateBottomCenter","x","width","left","top","y","show","margin","height","respectWindowScroll","rect","getBoundingClientRect","scrollX","scrollY","ModalPopup","renderRow","row","d3","then","catch","error","Page","application","title","renderHeader","renderBody","renderFooter","makeContainerNormal","centerHeaderContainer","toParent","addContainer","classes","newTitle","addRow","leftHeaderContainer","rightHeaderContainer","backButton","addBackButton","footerLinksContainer","presentModalPopup","bind","contentURL","frcvApp","impressPopup","loadContent","showBigModal","footerURLContainer","footerTooltipContainer","footerURLLabel","copyLocationToClipboard","footerURLLabelTooltip","urlPath","navigator","clipboard","writeText","err","footerCorpusInfoContainer","footerDebugLabel","updateFooterDebugInfo","footerLanguageInfoContainer","footerLanguageLabel","footerLanguageRadioGroup","setOptions","getInstance","Application","default","reloadPage","setSelectedOption","renderFooterRow","renderFooterLinks","renderFooterURL","renderFooterCorpusInfo","renderFooterLanguageInfo","updateFooterURL","label","isCorpusLoaded","valueTranslated","loadingView","addLoadingView","button","applicationReference","showPage","willLoadCorpus","didLoadCorpus","ref","loadCorpus","Option","Checkbox","renderInput","renderLabel","checkbox","checked","SearchPageSettingsPopup","renderViewRadioGroup","renderShowChartCheckbox","renderShowMapCheckbox","renderShowWordAboutCheckbox","viewRadioGroupLabel","viewRadioGroupContainer","viewRadioGroup","searchPage","setViewMode","showChartCheckboxLabel","showChartCheckboxContainer","showChartCheckbox","showChart","hideChart","setWithoutDeleting","showMapCheckboxLabel","showMapCheckboxContainer","showMapCheckbox","showMap","hideMap","showWordAboutCheckboxLabel","showWordAboutCheckboxContainer","showWordAboutCheckbox","showWordAbout","hideWordAbout","loadValues","viewMode","setChecked","diachronicChartCard","mapChartCard","wordAboutCard","ViewMode","Color","g","b","round","colorsForStack","stack","amount","Number","isInteger","stackColors","usedAmount","max","highColor","lowColor","redStep","greenStep","blueStep","colors","newColor","colorAdding","organgeLow","organgeHigh","redLow","redHigh","blueLow","blueHigh","lightBlueLow","lightBlueHight","greenLow","greenHight","TestData","datasets","data","year","yearTotal","DiachronicChart","Object","getPrototypeOf","String","prototype","select","initialize","update","defaultMargin","right","bottom","presentedDatasetGroups","presentedStacks","labelColor","rgbString","type","ChartType","Bar","isShowLabels","isCombineStacks","numberFormat","Intl","NumberFormat","maximumFractionDigits","getBoolean","_datasets","forEach","dataset","isEnabled","beforeDrawChart","drawChart","afterDrawChart","configureChart","calculatePresentedDatasets","calculateListOfDatasetNames","calculateListOfYears","calculateListOfStacks","calculateFlattenData","calculateDatasetsPerYear","calculateColors","calculateDatasetStacks","createSVG","createGraph","createScales","createAxis","renderAxis","renderGrid","renderStacks","renderLegend","renderMethod","renderBars","renderLine","graphWidth","graphHeight","presentedDatasets","filter","datasetRef","datasetsPerYearRef","presentedDatasetsPerYear","datasetStacks","listOfStacks","map","stackName","index","stackCandidates","candidatesNames","stackCandidate","candidatesColors","color","keys","allDatasetStacks","listOfAllStacks","datasetsPerYear","temporaryMap","Array","Set","temporaryMap2","listOfYears","item","listOfDatasetNames","flattenData","yearSet","entry","total","key","flat","removeSVG","svg","svgID","Image","graph","serie","values","xChart","scaleBand","domain","rangeRound","paddingInner","xDataset","bandwidth","padding","xStack","yChart","scaleLinear","nice","xAxisGrid","axisBottom","tickSize","tickFormat","yAxisGrid","axisLeft","ticks","call","renderBarLabels","xChartRef","yChartRef","xStackRef","enter","d","numberOfSeries","serieIndex","format","datasetGroups","debug","datum","line","x0","y0","curve","curveMonotoneX","dots","tooltip","searchText","relativeValue","pageX","pageY","renderLineLabels","renderCombinedStacksLegend","renderNormalLegend","datasetNames","xLegend","legends","legendsTexts","getSumForWord","innerHTML","split","toggleDataset","stackNames","getSumForStack","find","word","sum","Line","DiachronicChartSettingsPopup","renderShowLabelsCheckbox","renderCombineStacksCheckbox","renderRadios","container","showLabelsCheckbox","diachronicChart","combineStacksCheckbox","typeRadioGroup","screenshotElement","querySelector","html2canvas","canvas","link","createElement","setAttribute","toDataURL","appendChild","click","DiachronicChartCard","renderChart","renderScreenshotButton","renderMoreActionsButton","applyURLParameters","chart","chartID","screenshotButton","moreActionButton","presentSettingsPopup","getString","settingsPopup","showUnder","RecentSearchesLocalStorageKey","RecentSearches","loadFromLocalStorage","removeIfExisting","insert","storeToLocalStorage","splice","removeDispensableValues","tooMuch","wordlist","localStorage","getItem","setItem","join","SearchField","datalistId","datalist","onEnter","updateRecentSearches","recentSearches","Dropdown","selectId","renderSelect","removeAllInputs","argument","callback","optionID","undefined","LoadingView","InnovationListPopup","dataDidLoad","reducedData","components","variations","some","searchCard","searchField","startSearching","SearchCard","renderSearchField","renderCaseSensitiveDropdown","renderRangeDropdown","renderRelativeAbsolute","renderPresentInnovationListPopupButton","renderSearchButton","searchFieldContainer","caseSensetiveGroupContainer","sensitivityDropdown","yearStartContainer","yearStartDropdown","setLabelText","setOnChange","yearEndContainer","yearEndDropdown","container2","valueRadioGroup","presentInnovationListPopupButton","searchButton","getText","sensitivity","firstYear","lastYear","GeoJson","source","features","featureSource","feature","Feature","allCoordinates","extractAllCoordinates","latitudeSum","longitudeSum","coordinates","geometryCollection","geometry","Error","geometries","extractGeometryCollection","coordinatesCollection","coordinate","polygonCoordinates","featureCoordinates","properties","Geometry","flattenDatasets","flattenList","dlabel","combineDataByLabel","combined","listItem","entryItem","MapChart","initializeProjection","initializePath","renderSVG","renderMapBackground","renderTooltipContainer","tintColor","backgroundColor","backgroundOpacity","isDrawsBackground","isZoomable","geoJSON","departmentsData","excludedFeatureCodes","projection","geoMercator","path","geoPath","background","bounds","legend","center","geoCentroid","code","departmentNumber","boundsRectangle","propertyName","capitalize","datasetName","tooltipWidth","tooltipHeight","featureBounds","geoBounds","featureLowerLeft","featureUpperRight","featureBoundsWidth","featureBoundsHeight","effectiveSize","getElementEffectiveSize","widthFactor","heightFactor","positionOffset","getElementPosition","centerBottom","getStackNames","combinedData","dataForStack","datasetEntry","combine","raise","offset","steps","fitSize","geoJSONDidChange","datasetsDidChange","geoJSONURL","json","rawJSON","setGeoJSON","newGeoJSON","newDatasets","removeExcludedFeatures","zoomTo","renderGeoJson","renderDatasets","renderDatasetLabels","renderDatasetsLegend","candidate","candidateIndex","Slider","renderMinLabel","renderMaxLabel","renderValueLabel","minLabel","range","valueLabel","maxLabel","minimum","newMin","maximum","newMax","MapChartSettingsPopup","mapChart","MapChartCard","renderMenuItems","renderMapChart","slider","setFontAwesomeImage","screenshotButtonAction","moreButton","presentSettingsPopupAction","loadGeoJSON","TrackPopup","renderHeadline","renderTrackContentContainer","lyricsContainer","track","input","searchWord","lines","words","j","toLowerCase","WordAboutCard","divs","sort","item1","item2","descending","releaseYear","artist","DatasetCollection","SearchPage","makeContainerFull","renderSettingsButton","renderSearchInputCard","renderDiachronicChart","renderWordAboutCard","loadCorpusIfNeeded","settingsButton","searchCardContainer","diachronicChartCardContainer","mapCardContainer","wordAboutCardContainer","getSearchText","save","useFullWidthMode","useHalfWidthMode","viewModeKey","parameters","viewModeURL","viewModeLocalStorage","trim","searchFor","searchQuery","groups","group","searchTextFormatted","localDatasets","mapDatasets","trackDatasets","datasetObject","datasetFor","chartData","mapData","tracks","newDataset","mapDataset","corpus","tracksForWord","getMapDataForTracks","getChartDataForTracks","departementNumber","numberOfLyrics","departement","getDepartementForNumber","drawDepartement","CorpusDataPage","createLeftPanel","createCard","cardBody","leftPanel","wrapper","cardBodyRow","clearContent","currentGroup","createGroup","createLine","artists","femaleArtists","maleArtists","groupArtists","allAlbums","allTracksWithoutAlbum","allTracks","allWords","endsWith","ProgressBar","renderBar","barContainerSelector","barContainer","barSelector","bar","valueAsNumber","totalWidth","MainPage","renderLeftTitleComponent","renderMenuCard","renderProgressBar","hideBackButton","loadData","titleContainer","delegate","titleInfoBox","menuCardContainer","menuCard","pages","pageItem","pageId","pageTitle","addMenuButton","functionToCall","progressBar","progress","hide","DiachronicAboutPage","buildSubpage","renderContentRadioGroup","chartWrapper","chartCard","radioGroup","showLoadingView","hideLoadingView","setCorpus","yearCollection","getLyricsPerYear","getWordsPerYear","getWordsPerYearRelative","getTypesPerYear","getTypesPerYearRelative","getTotalNonStandardPerYearCount","min","charAt","toUpperCase","slice","ArtistsDataPage","createContentTypeRadioGroup","valueGettingFunction","numberOfTypes","renderTooltip","lineHeight","chartView","colorString","geniusId","barGroup","ratio","xPos","yPos","cardContainer","chartTypeAction","numberOfWords","numberOfTracks","numberOfAlbums","size","albums","hierarchy","reverse","artistName","departementNo","a","countAll","countFiltered","buildVisual","LocationDataPage","loadGeoJSONFromDelegate","didLoadGeoJSONFromDelegate","mapChartContainer","showLabels","DataDelegate","DefaultDataDelegate","willInitialize","didInitialize","loadPage","updateHistory","clearContainer","clear","currentPageSelector","AboutPage","completion","isLoading","isFetchingDepartements","fetch","response","departements","deptCode","Pages","exports"],"mappings":"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"}